{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/WorkShiftInput.vue?b853","webpack:///./src/App.vue?e52c","webpack:///./src/components/WorkShiftTable.vue?5684","webpack:///./src/App.vue?a49d","webpack:///./src/components/WorkShiftTable.vue?529a","webpack:///./src/components/WorkShiftInput.vue?7a7c","webpack:///./src/components/WorkShiftInput.vue?d5e2","webpack:///./src/components/WorkShiftInput.vue?0ecd","webpack:///./src/components/WorkShiftInput.vue?706f","webpack:///./src/models/Action.ts","webpack:///./src/services/ActionService.ts","webpack:///./src/utils/DayOfWeek.ts","webpack:///./src/utils/ConfigLog4j.ts","webpack:///./src/services/DateService.ts","webpack:///./src/utils/Cache.ts","webpack:///./src/utils/Stats.ts","webpack:///./src/utils/Decorators.ts","webpack:///./src/services/WorkShiftService.ts","webpack:///./src/services/ShiftValidationService.ts","webpack:///./src/models/WeekConstraint.ts","webpack:///./src/services/WeekConstraintService.ts","webpack:///./src/utils/EventBus.ts","webpack:///./src/utils/WebService.ts","webpack:///./src/utils/GlobalNotification.ts","webpack:///./src/services/OptimizeShiftsService.ts","webpack:///./src/services/ApplicationContext.ts","webpack:///./src/components/WorkShiftTable.vue?66ad","webpack:///./src/components/WorkShiftTable.vue?b3a7","webpack:///./src/components/WorkShiftTable.vue?8f06","webpack:///./src/components/WorkShiftActions.vue?17ff","webpack:///./src/components/WorkShiftActions.vue","webpack:///./src/components/WorkShiftActions.vue?a0f4","webpack:///./src/components/WorkShiftActions.vue?94e3","webpack:///./src/components/ErrorDialog.vue?e048","webpack:///./src/components/ErrorDialog.vue","webpack:///./src/components/ErrorDialog.vue?409e","webpack:///./src/components/ErrorDialog.vue?6857","webpack:///./src/components/LoaderDialog.vue?7d43","webpack:///./src/components/LoaderDialog.vue","webpack:///./src/components/LoaderDialog.vue?df0b","webpack:///./src/components/LoaderDialog.vue?7466","webpack:///./src/models/AvailableCars.ts","webpack:///./src/models/Shift.ts","webpack:///./src/utils/ArrayUtil.ts","webpack:///./src/models/WorkContext.ts","webpack:///./src/models/Employee.ts","webpack:///./src/models/Group.ts","webpack:///./src/models/Subgroup.ts","webpack:///./src/components/MonthPicker.vue?19c1","webpack:///./src/components/MonthPicker.vue","webpack:///./src/components/MonthPicker.vue?24bf","webpack:///./src/components/MonthPicker.vue?50da","webpack:///./src/transformer/ContextDeserializer.ts","webpack:///./src/transformer/ContextSerializer.ts","webpack:///./src/App.vue","webpack:///./src/App.vue?31c5","webpack:///./src/App.vue?68bd","webpack:///./src/store/index.ts","webpack:///./src/plugins/vuetify.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","context","from","on","handleUpdateDate","handleValidation","handleExportJson","handleImportJson","handleExportExcel","handleClearData","handleOptimize","inlineValidation","employeeId","day","handleShift","staticRenderFns","scopedSlots","_u","fn","_l","days","dayId","class","isEndOfWeek","_s","formatHeaderDate","getDayOfWeekLabel","tableElements","tableElement","id","type","isGroup","getGroupName","_e","hasGroupErrors","ref","onTooltip","_g","getGroupErrors","error","isSubgroup","getSubgroupName","hasSubgroupErrors","getSubgroupErrors","isEmployee","isStartOfSubgroup","getEmployee","hasEmployeeErrors","getShift","availableStates","v","getEmployeeErrors","errors","hasCarsErrors","morningAction","getUsedCars","getCarsErrors","getTotCars","afternoonAction","proxy","hasErrors","onMenu","item","index","$event","select","$emit","component","VList","VListItem","VListItemTitle","VMenu","Action","DayOfWeek","labels","getLabels","IDLE","forEach","MORNING","AFTERNOON","AWAY","action","getIdleLabel","actionName","actions","getActions","filter","actionEnum","getActionName","Error","getDefaultLabel","label","indexOf","options","addLogGroupRule","RegExp","Info","factory","createNamedLoggerFactory","logger","getLogger","date","getDayOfWeek","MONDAY","SUNDAY","createDate","getFullYear","getMonth","startOfWeek","isStartOfWeek","addDays","endOfWeek","getDay","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","dayOfWeek","dayOfWeekName","getDaysOfWeek","dayEnum","getDayOfWeekName","text","year","month","values","split","parseInt","e","getDate","padding","leftPadding","Date","isNaN","getTime","to","range","Array","currentDate","clone","isAfter","date1","date2","isValidDate","setHours","debug","format","getStartOfWeek","getEndOfWeek","dates","weeksWithDuplicates","map","getWeek","weeks","week","w","setDate","isWeekend","str","paddingString","timestamp","performance","now","timing","navigationStart","maxSize","ttl","config","CacheConfig","_instance","inserted","hits","miss","evict","size","_entries","Map","_stats","validateEntry","cleanup","set","doEvict","has","entry","delete","numberOfEntriesToBeDeleted","Math","max","toBeDeleted","entries","sort","a","b","_caches","cache","CacheManager","setInterval","getInstance","caches","info","stats","resetStats","durationsSize","longCallThreshold","_counter","_longCallsCounter","_durations","duration","total","reduce","acc","counter","avg","increaseCounter","addDuration","StatsCollector","addEntry","weight","reverse","longCalls","toPrecision","resetEntry","className","target","descriptor","originalMethod","fullName","undefined","startTime","args","cacheable","methodName","entryKey","cachedValue","put","actionService","getActionService","dateService","getDateService","employees","flatMap","getAction","countByEmployeesDatesAction","prev","curr","shifts","employee","startOfMonth","getStartOfMonth","endOfMonth","getEndOfMonth","sunday","weekend","tot","countByEmployeesDatesActions","monday","expected","totWeekShifts","isWeekendWorking","isPreviousWeekendWorking","maxWeekMornings","maxWeekAfternoons","toISOString","build","workShiftService","getWorkShiftService","getExpectedEmployeeTotShiftsInWeek","expectedMornings","getExpectedEmployeeMorningShiftsInWeek","actualMornings","expectedAfternoons","getExpectedEmployeeAfternoonShiftsInWeek","actualAfternoons","availableCars","groupId","targetGroup","getGroup","employeeIdsInTargetGroup","getGroupByEmployee","expectedMinMornings","getWeekConstraintService","getMinValue","constraints","expectedMinAfternoons","getGroupById","getSubgroupById","getSubgroupByEmployee","employeeErrors","groupErrors","validators","validator","TYPE_MIN","_dayOfWeek","_action","_type","_value","WeekConstraint","EventBus","_url","_method","_headers","_responseType","_spinner","_requestSerializer","request","JSON","stringify","header","method","serializer","payload","callName","instance","interceptors","use","url","response","status","statusText","headers","responseType","configs","env","frontendUrls","backendUrl","fullUrl","getBackendUrl","location","getCurrentUrl","cfg","frontendUrl","protocol","hostname","port","title","message","wsError","notifications","notification","MAX_INTEGER","min","variable","coefficient","_name","_coefficient","coefficients","getVariable","constraintToString","constraint","dateFormatted","variables","objectives","outCtx","variableValues","serializeVariable","constraintValues","serializeConstraint","objective","getObjectives","serializeObjective","serializeCoefficient","obj","opt","addVariable","addConstraint","oneActivityPerDay","addCoefficient","expectedTot","employeeWeeklyTotActivities","morning","employeeWeeklyMorningActivities","afternoon","employeeWeeklyAfternoonActivities","carsDailyActivities","weekConstraintService","employeeIds","getEmployeeIdsInGroup","group","expectedMin","getExpectedMin","getConstraintName","createOptimizationContext","post","headerJson","serialize","then","solutions","fastSolutions","solution","validateSolutions","sortedEmployees","updateContext","catch","getErrorNotifications","add","getWeeks","groupsDailyConstraints","groups","subgroupsDailyConstraints","subgroups","carsConstraints","addObjectiveCoefficient","isDebugEnabled","constraintNames","constraintName","getConstraint","variableNames","selected","getSolution","newAction","currAction","setShift","rangeStart","rangeEnd","_instances","getService","initializr","_context","ApplicationContext","TableElement","GROUP","SUBGROUP","EMPLOYEE","$store","commit","state","count","getShiftValidationService","elements","subgroup","isStartOfGroup","formatShort","findIndex","prevEmployeeId","currEmployee","prevEmployee","subgroupId","currGroup","prevGroup","service","getAllLabels","init","components","WorkShiftInput","VContainer","VRow","VSimpleTable","VTooltip","model","callback","$$v","validate","expression","_b","deleteDialog","file","VBtn","VCard","VCardActions","VCardTitle","VCol","VDialog","VFileInput","VIcon","VSpacer","VSwitch","stopPropagation","acceptMessage","extend","computed","methods","pop","watch","handler","deep","VCardText","dialog","pending","mounted","$on","VOverlay","VProgressLinear","_total","_employeeId","_date","Shift","list","match","_employees","_groups","_subgroups","_availableCars","_workShifts","_workShiftsMap","employee1","employee2","idSubgroup1","idSubgroup2","subgroup1","subgroup2","idGroup1","parent","idGroup2","group1","group2","workShifts","setShiftMap","defaultValue","_id","_subgroupId","Employee","_constraints","doClone","Group","Subgroup","_parent","currentValue","menu","update","toUTCString","substring","VDatePicker","VTextField","dateValue","deserializeEmployee","deserializeGroup","deserializeSubgroup","deserializeShift","numberValue","stringValue","g","deserializeWeekConstraint","getDayOfWeekFromName","getActionFromName","parse","keys","targetIndex","serializeEmployee","serializeGroup","serializeSubgroup","serializeShift","serializeWeekConstraint","weekConstraint","serializeContext","blob","Blob","formattedDate","formatYYYYMM","filename","content","reader","FileReader","readAsText","onload","json","deserializeContext","deleteShifts","getOptimizeShiftsService","optimize","parentId","minMorningsWeekdays","minAfternoonsWeekdays","minMorningsWeekends","minAfternoonsWeekends","getWeekdays","getWeekendDays","WorkShiftTable","MonthPicker","WorkShiftActions","ErrorDialog","LoaderDialog","VApp","VAppBar","VContent","Store","fromDate","toDate","mutations","increment","updateFromDate","updateToDate","productionTip","store","vuetify","render","h","$mount"],"mappings":"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","file":"js/app.71bb5e14.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftInput.vue?vue&type=style&index=0&id=6a37c614&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftInput.vue?vue&type=style&index=0&id=6a37c614&scoped=true&lang=css&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftTable.vue?vue&type=style&index=0&id=2227b553&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftTable.vue?vue&type=style&index=0&id=2227b553&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-app-bar',{attrs:{\"app\":\"\",\"color\":\"primary\",\"dark\":\"\"}},[_c('div',{staticClass:\"d-flex align-center\"},[_c('h1',[_vm._v(\"Turni Lavorativi\")])])]),_c('error-dialog'),_c('loader-dialog'),_c('v-content',[_c('v-row',{attrs:{\"justify\":\"space-between\"}},[_c('MonthPicker',{attrs:{\"initialValue\":_vm.context.from},on:{\"update-date\":_vm.handleUpdateDate}}),_c('WorkShiftActions',{on:{\"update-validation\":_vm.handleValidation,\"export-json\":_vm.handleExportJson,\"import-json\":_vm.handleImportJson,\"export-excel\":_vm.handleExportExcel,\"clear-data\":_vm.handleClearData,\"optimize\":_vm.handleOptimize}})],1),_c('v-row',[_c('WorkShiftTable',{attrs:{\"context\":_vm.context,\"inlineValidation\":_vm.inlineValidation},on:{\"update-shift\":function (employeeId, day, value) { return _vm.handleShift(employeeId, day, value); }}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',[_c('v-simple-table',{staticClass:\"single-line\",attrs:{\"dense\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('thead',[_c('tr',[_c('th',{staticClass:\"text-left start-of-group end-of-week\",attrs:{\"colspan\":\"2\"}},[_vm._v(\" Name \")]),_vm._l((_vm.days()),function(dayId){return _c('th',{key:dayId,class:{\n                'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                'table-header': true,\n                'text-center': true,\n                'start-of-group': true\n              }},[_vm._v(\" \"+_vm._s(_vm.formatHeaderDate(_vm.day(dayId)))+\" \")])})],2),_c('tr',[_c('th',{staticClass:\"text-left\"}),_c('th',{staticClass:\"text-left end-of-week\"}),_vm._l((_vm.days()),function(dayId){return _c('th',{key:dayId,class:{\n                'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                'table-header': true,\n                'text-center': true\n              }},[_vm._v(\" \"+_vm._s(_vm.getDayOfWeekLabel(_vm.day(dayId)))+\" \")])})],2)]),_c('tbody',[_vm._l((_vm.tableElements()),function(tableElement){return _c('tr',{key:tableElement.id + tableElement.type},[(tableElement.isGroup())?_c('td',{staticClass:\"start-of-group end-of-week table-element-name-1\",attrs:{\"colspan\":\"2\"}},[_vm._v(\" \"+_vm._s(_vm.getGroupName(tableElement.id))+\" \")]):_vm._e(),(tableElement.isGroup())?_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                  'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                  'start-of-group': true,\n                  'full-space': true\n                }},[(_vm.hasGroupErrors(tableElement.id, _vm.day(dayId)))?_c('v-tooltip',{attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n                var onTooltip = ref.on;\nreturn [_c('div',_vm._g({staticClass:\"errors\"},onTooltip),[_vm._v(\"-\")])]}}],null,true)},_vm._l((_vm.getGroupErrors(\n                      tableElement.id,\n                      _vm.day(dayId)\n                    )),function(error){return _c('div',{key:error},[_vm._v(\" \"+_vm._s(error)+\" \")])}),0):_vm._e()],1)}):_vm._e(),(tableElement.isSubgroup())?_c('td',{staticClass:\"start-of-subgroup end-of-week table-element-name-2\",attrs:{\"colspan\":\"2\"}},[_vm._v(\" \"+_vm._s(_vm.getSubgroupName(tableElement.id))+\" \")]):_vm._e(),(tableElement.isSubgroup())?_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                  'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                  'start-of-subgroup': true,\n                  'full-space': true\n                }},[(_vm.hasSubgroupErrors(tableElement.id, _vm.day(dayId)))?_c('v-tooltip',{attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n                var onTooltip = ref.on;\nreturn [_c('div',_vm._g({staticClass:\"errors\"},onTooltip),[_vm._v(\"-\")])]}}],null,true)},_vm._l((_vm.getSubgroupErrors(\n                      tableElement.id,\n                      _vm.day(dayId)\n                    )),function(error){return _c('div',{key:error},[_vm._v(\" \"+_vm._s(error)+\" \")])}),0):_vm._e()],1)}):_vm._e(),(tableElement.isEmployee())?_c('td',{class:{\n                'end-of-week': true,\n                'table-element-name-3': true,\n                'start-of-subgroup': _vm.isStartOfSubgroup(tableElement.id)\n              },attrs:{\"colspan\":\"2\"}},[_vm._v(\" \"+_vm._s(tableElement.id)+\" - \"+_vm._s(_vm.context.getEmployee(tableElement.id).name)+\" \")]):_vm._e(),(tableElement.isEmployee())?_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                  'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                  'start-of-subgroup': _vm.isStartOfSubgroup(tableElement.id),\n                  'full-space': true\n                }},[(_vm.hasEmployeeErrors(tableElement.id, _vm.day(dayId)))?_c('v-tooltip',{attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n                var onTooltip = ref.on;\nreturn [_c('span',_vm._g({},onTooltip),[_c('WorkShiftInput',{attrs:{\"value\":_vm.getShift(tableElement.id, _vm.day(dayId)),\"items\":_vm.availableStates(),\"hasErrors\":true},on:{\"update-value\":function (v) { return _vm.handleShift(tableElement.id, _vm.day(dayId), v); }}})],1)]}}],null,true)},_vm._l((_vm.getEmployeeErrors(\n                      tableElement.id,\n                      _vm.day(dayId)\n                    )),function(error){return _c('div',{key:error},[_vm._v(\" \"+_vm._s(error)+\" \")])}),0):_c('WorkShiftInput',{attrs:{\"value\":_vm.getShift(tableElement.id, _vm.day(dayId)),\"items\":_vm.availableStates(),\"hasErrors\":false},on:{\"update-value\":function (v) { return _vm.handleShift(tableElement.id, _vm.day(dayId), v); }}})],1)}):_vm._e()],2)}),_c('tr',[_c('td',{staticClass:\"text-left\",attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Mattina\")]),_c('td',{staticClass:\"text-left end-of-week\"},[_vm._v(\"Usate\")]),_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                'table-header': true,\n                'text-center': true,\n                errors: _vm.hasCarsErrors(_vm.morningAction(), _vm.day(dayId))\n              }},[(_vm.hasCarsErrors(_vm.morningAction(), _vm.day(dayId)))?_c('v-tooltip',{attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n              var onTooltip = ref.on;\nreturn [_c('span',_vm._g({},onTooltip),[_vm._v(\" \"+_vm._s(_vm.getUsedCars(_vm.day(dayId), _vm.morningAction()))+\" \")])]}}],null,true)},[_c('span',_vm._l((_vm.getCarsErrors(\n                      _vm.morningAction(),\n                      _vm.day(dayId)\n                    )),function(error){return _c('div',{key:error},[_vm._v(\" \"+_vm._s(error)+\" \")])}),0)]):_c('span',[_vm._v(\" \"+_vm._s(_vm.getUsedCars(_vm.day(dayId), _vm.morningAction()))+\" \")])],1)})],2),_c('tr',[_c('td',{staticClass:\"text-left end-of-week\"},[_vm._v(\"Disponibili\")]),_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                'table-header': true,\n                'text-center': true\n              }},[_vm._v(\" \"+_vm._s(_vm.getTotCars())+\" \")])})],2),_c('tr',[_c('td',{staticClass:\"text-left\",attrs:{\"rowspan\":\"2\"}},[_vm._v(\"Pomeriggio\")]),_c('td',{staticClass:\"text-left end-of-week\"},[_vm._v(\"Usate\")]),_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                'table-header': true,\n                'text-center': true,\n                errors: _vm.hasCarsErrors(_vm.afternoonAction(), _vm.day(dayId))\n              }},[(_vm.hasCarsErrors(_vm.afternoonAction(), _vm.day(dayId)))?_c('v-tooltip',{attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n              var onTooltip = ref.on;\nreturn [_c('span',_vm._g({},onTooltip),[_vm._v(\" \"+_vm._s(_vm.getUsedCars(_vm.day(dayId), _vm.afternoonAction()))+\" \")])]}}],null,true)},[_c('span',_vm._l((_vm.getCarsErrors(\n                      _vm.afternoonAction(),\n                      _vm.day(dayId)\n                    )),function(error){return _c('div',{key:error},[_vm._v(\" \"+_vm._s(error)+\" \")])}),0)]):_c('span',[_vm._v(\" \"+_vm._s(_vm.getUsedCars(_vm.day(dayId), _vm.afternoonAction()))+\" \")])],1)})],2),_c('tr',[_c('td',{staticClass:\"text-left end-of-week\"},[_vm._v(\"Disponibili\")]),_vm._l((_vm.days()),function(dayId){return _c('td',{key:dayId,class:{\n                'end-of-week': _vm.isEndOfWeek(_vm.day(dayId)),\n                'table-header': true,\n                'text-center': true\n              }},[_vm._v(\" \"+_vm._s(_vm.getTotCars())+\" \")])})],2)],2)]},proxy:true}])})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{\n    'text-center': true,\n    errors: _vm.hasErrors\n  }},[_c('v-menu',{attrs:{\"offset-y\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n  var onMenu = ref.on;\nreturn [_c('span',_vm._g({},onMenu),[_vm._v(_vm._s(_vm.value))])]}}])},[_c('v-list',_vm._l((_vm.items),function(item,index){return _c('v-list-item',{key:index,on:{\"click\":function($event){return _vm.select(item)}}},[_c('v-list-item-title',[_vm._v(_vm._s(item))])],1)}),1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\n\n@Component\nexport default class WorkShiftInput extends Vue {\n  @Prop() private items!: Array<string>;\n  @Prop() private value?: string;\n  @Prop() private hasErrors!: boolean;\n\n  private select(value: string) {\n    this.$emit(\"update-value\", value);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./WorkShiftInput.vue?vue&type=template&id=6a37c614&scoped=true&\"\nimport script from \"./WorkShiftInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./WorkShiftInput.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./WorkShiftInput.vue?vue&type=style&index=0&id=6a37c614&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6a37c614\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VList } from 'vuetify/lib/components/VList';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\ninstallComponents(component, {VList,VListItem,VListItemTitle,VMenu})\n","export enum Action {\n  IDLE,\n  MORNING,\n  AFTERNOON,\n  AWAY\n}\n","import { Action } from \"../models/Action\";\r\n\r\nexport class ActionService {\r\n  public getAllLabels(): Array<string> {\r\n    const labels: string[] = [];\r\n    this.getLabels(Action.IDLE).forEach(value => labels.push(value));\r\n    this.getLabels(Action.MORNING).forEach(value => labels.push(value));\r\n    this.getLabels(Action.AFTERNOON).forEach(value => labels.push(value));\r\n    this.getLabels(Action.AWAY).forEach(value => labels.push(value));\r\n    return labels;\r\n  }\r\n\r\n  public getLabels(action: Action): Array<string> {\r\n    if (action == Action.MORNING) {\r\n      return [\"M\", \"M*\"];\r\n    }\r\n    if (action == Action.AFTERNOON) {\r\n      return [\"P\", \"P*\", \"PJ\"];\r\n    }\r\n    if (action == Action.AWAY) {\r\n      return [\"F\", \"Rec\", \"Agg\", \"mal\", \"/\", \"L104\"];\r\n    }\r\n    if (action == Action.IDLE) {\r\n      return [this.getIdleLabel()];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  public getActions(): Array<Action> {\r\n    return [Action.MORNING, Action.AFTERNOON, Action.AWAY, Action.IDLE];\r\n  }\r\n\r\n  public getActionName(action: Action): string {\r\n    switch (action) {\r\n      case Action.MORNING:\r\n        return \"MORNING\";\r\n      case Action.AFTERNOON:\r\n        return \"AFTERNOON\";\r\n      case Action.AWAY:\r\n        return \"AWAY\";\r\n      case Action.IDLE:\r\n        return \"IDLE\";\r\n    }\r\n  }\r\n\r\n  public getActionFromName(actionName: string): Action {\r\n    const actions = this.getActions().filter(actionEnum => {\r\n      const name = this.getActionName(actionEnum);\r\n      return name == actionName;\r\n    });\r\n    if (actions.length == 1) {\r\n      return actions[0];\r\n    }\r\n    throw new Error(`Cannot convert [${actionName}] to an Action obj`);\r\n  }\r\n\r\n  public getIdleLabel(): string {\r\n    return this.getDefaultLabel();\r\n  }\r\n\r\n  public getDefaultLabel(): string {\r\n    return \"---\";\r\n  }\r\n\r\n  public getAction(label: string): Action {\r\n    if (this.getLabels(Action.IDLE).indexOf(label) != -1) {\r\n      return Action.IDLE;\r\n    }\r\n    if (this.getLabels(Action.MORNING).indexOf(label) != -1) {\r\n      return Action.MORNING;\r\n    }\r\n    if (this.getLabels(Action.AFTERNOON).indexOf(label) != -1) {\r\n      return Action.AFTERNOON;\r\n    }\r\n    if (this.getLabels(Action.AWAY).indexOf(label) != -1) {\r\n      return Action.AWAY;\r\n    }\r\n    throw new Error(\"Label [\" + label + \"] not recognized as an action\");\r\n  }\r\n}\r\n","export enum DayOfWeek {\r\n  MONDAY = 1,\r\n  TUESDAY = 2,\r\n  WEDNESDAY = 3,\r\n  THURSDAY = 4,\r\n  FRIDAY = 5,\r\n  SATURDAY = 6,\r\n  SUNDAY = 0\r\n}\r\n","import {\n  LoggerFactoryOptions,\n  LFService,\n  LogGroupRule,\n  LogLevel\n} from \"typescript-logging\";\n\n// https://github.com/mreuvers/typescript-logging\n\n// Create options instance and specify 2 LogGroupRules:\n// * One for any logger with a name starting with model, to log on debug\n// * The second one for anything else to log on info\nconst options = new LoggerFactoryOptions()\n  .addLogGroupRule(\n    new LogGroupRule(\n      new RegExp(\"services.OptimizeShiftsService\"),\n      LogLevel.Info\n    )\n  )\n  .addLogGroupRule(new LogGroupRule(new RegExp(\"services.+\"), LogLevel.Info))\n  .addLogGroupRule(\n    new LogGroupRule(\n      new RegExp(\"utils.Decorators.StatsCollector\"),\n      LogLevel.Error\n    )\n  )\n  .addLogGroupRule(\n    new LogGroupRule(new RegExp(\"utils.Cache.stats\"), LogLevel.Error)\n  )\n  .addLogGroupRule(\n    new LogGroupRule(new RegExp(\"utils.Stats.stats\"), LogLevel.Error)\n  )\n  .addLogGroupRule(new LogGroupRule(new RegExp(\".+\"), LogLevel.Info));\n\n// Create a named loggerfactory and pass in the options and export the factory.\n// Named is since version 0.2.+ (it's recommended for future usage)\nexport const factory = LFService.createNamedLoggerFactory(\n  \"LoggerFactory\",\n  options\n);\n","import { factory } from \"@/utils/ConfigLog4j\";\nimport { DayOfWeek } from \"@/utils/DayOfWeek\";\n\nexport class DateService {\n  private logger = factory.getLogger(\"services.DateService\");\n  public isStartOfWeek(date: Date) {\n    return this.getDayOfWeek(date) == DayOfWeek.MONDAY;\n  }\n\n  public isEndOfWeek(date: Date) {\n    return this.getDayOfWeek(date) == DayOfWeek.SUNDAY;\n  }\n\n  public getStartOfMonth(date: Date) {\n    return this.createDate(date.getFullYear(), date.getMonth(), 1);\n  }\n\n  public getEndOfMonth(date: Date) {\n    return this.createDate(date.getFullYear(), date.getMonth() + 1, 0);\n  }\n\n  public getStartOfWeek(date: Date): Date {\n    let startOfWeek = date;\n    while (!this.isStartOfWeek(startOfWeek)) {\n      startOfWeek = this.addDays(startOfWeek, -1);\n    }\n    return startOfWeek;\n  }\n  public getEndOfWeek(date: Date): Date {\n    let endOfWeek = date;\n    while (!this.isEndOfWeek(endOfWeek)) {\n      endOfWeek = this.addDays(endOfWeek, +1);\n    }\n    return endOfWeek;\n  }\n\n  public getDayOfWeek(date: Date): DayOfWeek {\n    switch (date.getDay()) {\n      case 1:\n        return DayOfWeek.MONDAY;\n      case 2:\n        return DayOfWeek.TUESDAY;\n      case 3:\n        return DayOfWeek.WEDNESDAY;\n      case 4:\n        return DayOfWeek.THURSDAY;\n      case 5:\n        return DayOfWeek.FRIDAY;\n      case 6:\n        return DayOfWeek.SATURDAY;\n      case 0:\n        return DayOfWeek.SUNDAY;\n      default:\n        throw new Error(\"Unrecognized date \" + date);\n    }\n  }\n\n  public getDayOfWeekLabel(dayOfWeek: DayOfWeek): string {\n    switch (dayOfWeek) {\n      case DayOfWeek.MONDAY:\n        return \"L\";\n      case DayOfWeek.TUESDAY:\n        return \"M\";\n      case DayOfWeek.WEDNESDAY:\n        return \"M\";\n      case DayOfWeek.THURSDAY:\n        return \"G\";\n      case DayOfWeek.FRIDAY:\n        return \"V\";\n      case DayOfWeek.SATURDAY:\n        return \"S\";\n      case DayOfWeek.SUNDAY:\n        return \"D\";\n    }\n  }\n  public getDayOfWeekName(dayOfWeek: DayOfWeek): string {\n    switch (dayOfWeek) {\n      case DayOfWeek.MONDAY:\n        return \"MONDAY\";\n      case DayOfWeek.TUESDAY:\n        return \"TUESDAY\";\n      case DayOfWeek.WEDNESDAY:\n        return \"WEDNESDAY\";\n      case DayOfWeek.THURSDAY:\n        return \"THURSDAY\";\n      case DayOfWeek.FRIDAY:\n        return \"FRIDAY\";\n      case DayOfWeek.SATURDAY:\n        return \"SATURDAY\";\n      case DayOfWeek.SUNDAY:\n        return \"SUNDAY\";\n    }\n  }\n\n  public getDayOfWeekFromName(dayOfWeekName: string): DayOfWeek {\n    const days = this.getDaysOfWeek().filter(dayEnum => {\n      const name = this.getDayOfWeekName(dayEnum);\n      return name == dayOfWeekName;\n    });\n    if (days.length == 1) {\n      return days[0];\n    }\n    throw new Error(`Cannot convert [${dayOfWeekName}] to a DayOfWeek obj`);\n  }\n\n  public getDaysOfWeek(): DayOfWeek[] {\n    return [\n      DayOfWeek.MONDAY,\n      DayOfWeek.TUESDAY,\n      DayOfWeek.WEDNESDAY,\n      DayOfWeek.THURSDAY,\n      DayOfWeek.FRIDAY,\n      DayOfWeek.SATURDAY,\n      DayOfWeek.SUNDAY\n    ];\n  }\n\n  /**\n   * Parse a string in the format \"yyyy-MM-dd\" or \"yyyy-MM\"\n   * @param text\n   */\n  public parse(text: string): Date {\n    let year = 0;\n    let month = 0;\n    let day = 1;\n\n    try {\n      const values = text.split(\"-\");\n      year = parseInt(values[0]);\n      month = parseInt(values[1]) - 1;\n      if (values.length == 3) {\n        day = parseInt(values[2]);\n      }\n    } catch (e) {\n      throw Error(\"Text \" + text + \" is not a valid date.\" + e);\n    }\n    return this.createDate(year, month, day);\n  }\n\n  public format(date: Date): string {\n    const year = date.getFullYear();\n    const month = date.getMonth() + 1;\n    const day = date.getDate();\n\n    const padding = (n: number) => this.leftPadding(\"\" + n, \"0\", 2);\n    return `${year}-${padding(month)}-${padding(day)}`;\n  }\n\n  public formatShort(date: Date) {\n    const month = date.getMonth() + 1;\n    const day = date.getDate();\n    const padding = (n: number) => this.leftPadding(\"\" + n, \"0\", 2);\n    return `${padding(day)}-${padding(month)}`;\n  }\n\n  public formatYYYYMM(date: Date): string {\n    const year = date.getFullYear();\n    const month = date.getMonth() + 1;\n    const padding = (n: number) => this.leftPadding(\"\" + n, \"0\", 2);\n    return `${year}-${padding(month)}`;\n  }\n\n  public isValidDate(date: Date): boolean {\n    return date instanceof Date && !isNaN(date.getTime());\n  }\n\n  public range(from: Date, to: Date): Array<Date> {\n    const range = Array<Date>();\n\n    let currentDate = this.clone(from);\n    while (!this.isAfter(currentDate, to)) {\n      range.push(currentDate);\n      currentDate = this.addDays(currentDate, 1);\n    }\n    return range;\n  }\n\n  public isBefore(date1: Date, date2: Date): boolean {\n    return date1 < date2;\n  }\n\n  public isAfter(date1: Date, date2: Date): boolean {\n    return date1 > date2;\n  }\n\n  public createDate(year: number, month: number, day: number): Date {\n    const date = new Date(year, month, day);\n    if (!this.isValidDate(date)) {\n      throw Error(\n        \"Not a valid date. [\" + year + \"] [\" + month + \"] [\" + day + \"]\"\n      );\n    }\n    date.setHours(0, 0, 0, 0);\n    return date;\n  }\n\n  public getWeek(date: Date): Array<Date> {\n    this.logger.debug(() => `Input: ${this.format(date)}`);\n    const startOfWeek = this.getStartOfWeek(date);\n    const endOfWeek = this.getEndOfWeek(date);\n    this.logger.debug(\n      () => `Output: ${this.format(startOfWeek)} - ${this.format(endOfWeek)}`\n    );\n    return this.range(startOfWeek, endOfWeek);\n  }\n\n  public getWeeks(dates: Array<Date>): Array<Array<Date>> {\n    const weeksWithDuplicates = dates.map(date => this.getWeek(date));\n    const weeks = new Array<Array<Date>>();\n    const format = (dates: Array<Date>) => this.format(dates[0]);\n\n    weeksWithDuplicates.forEach(week => {\n      if (weeks.filter(w => format(w) == format(week)).length == 0) {\n        weeks.push(week);\n      }\n    });\n    return weeks;\n  }\n\n  private clone(date: Date): Date {\n    return new Date(date.getTime());\n  }\n\n  public addDays(date: Date, days: number): Date {\n    const clone = this.clone(date);\n    clone.setDate(clone.getDate() + days);\n    return clone;\n  }\n  public getWeekendDays(): DayOfWeek[] {\n    return this.getDaysOfWeek().filter(dayOfWeek => this.isWeekend(dayOfWeek));\n  }\n  public getWeekdays(): DayOfWeek[] {\n    return this.getDaysOfWeek().filter(dayOfWeek => !this.isWeekend(dayOfWeek));\n  }\n  public isWeekend(dayOfWeek: DayOfWeek): boolean {\n    switch (dayOfWeek) {\n      case DayOfWeek.MONDAY:\n      case DayOfWeek.TUESDAY:\n      case DayOfWeek.WEDNESDAY:\n      case DayOfWeek.THURSDAY:\n      case DayOfWeek.FRIDAY:\n        return false;\n      default:\n        return true;\n    }\n  }\n\n  protected leftPadding(\n    str: string,\n    paddingString: string,\n    padding: number\n  ): string {\n    while (str.length < padding) {\n      str = paddingString + str;\n    }\n    return str;\n  }\n}\n","import { factory } from \"../utils/ConfigLog4j\";\r\n\r\nconst timestamp = () =>\r\n  window.performance &&\r\n  window.performance.now &&\r\n  window.performance.timing &&\r\n  window.performance.timing.navigationStart\r\n    ? window.performance.now() + window.performance.timing.navigationStart\r\n    : Date.now();\r\n\r\nexport class CacheConfig {\r\n  public maxSize = 1000;\r\n  public ttl = 500;\r\n\r\n  public static init(maxSize: number, ttl: number): CacheConfig {\r\n    const config = new CacheConfig();\r\n    config.maxSize = maxSize;\r\n    config.ttl = ttl;\r\n    return config;\r\n  }\r\n\r\n  public toString(): string {\r\n    return `maxSize: ${this.maxSize} ttl: ${this.ttl}`;\r\n  }\r\n}\r\n\r\nexport class CacheConfigFactory {\r\n  private _instance = new CacheConfig();\r\n\r\n  public maxSize(maxSize: number): CacheConfigFactory {\r\n    this._instance.maxSize = maxSize;\r\n    return this;\r\n  }\r\n  public ttl(ttl: number): CacheConfigFactory {\r\n    this._instance.ttl = ttl;\r\n    return this;\r\n  }\r\n  public build(): CacheConfig {\r\n    return this._instance;\r\n  }\r\n}\r\n\r\nclass CacheEntry<V> {\r\n  public value: V;\r\n  public inserted = timestamp();\r\n\r\n  public constructor(value: V) {\r\n    this.value = value;\r\n  }\r\n}\r\n\r\nclass CacheStats {\r\n  public hits = 0;\r\n  public miss = 0;\r\n  public evict = 0;\r\n  public size = 0;\r\n}\r\n\r\nexport class Cache<K, V> {\r\n  private logger = factory.getLogger(\"utils.Cache.Cache\");\r\n  private _entries: Map<any, CacheEntry<V>> = new Map();\r\n  protected _stats = new CacheStats();\r\n  public config = new CacheConfig();\r\n\r\n  public get(key: K): V | undefined {\r\n    this.validateEntry(key);\r\n    const value = this._entries.get(key)?.value;\r\n    if (typeof value !== \"undefined\") {\r\n      this.logger.debug(() => `HIT! ${key}`);\r\n      this._stats.hits++;\r\n    } else {\r\n      this.logger.debug(() => `MISS! ${key}`);\r\n      this._stats.miss++;\r\n    }\r\n    return value;\r\n  }\r\n  public put(key: K, value: V) {\r\n    if (this.size() >= this.config.maxSize) {\r\n      this.cleanup();\r\n    }\r\n    this.logger.debug(() => `SIZE: ${this.size()}`);\r\n    this._stats.size = this.size();\r\n    this._entries.set(key, new CacheEntry(value));\r\n  }\r\n\r\n  public evict(key: K) {\r\n    this.doEvict(key);\r\n  }\r\n\r\n  protected validateEntry(key: K): void {\r\n    if (!this._entries.has(key)) {\r\n      return;\r\n    }\r\n    const entry = this._entries.get(key) as CacheEntry<V>;\r\n    if (timestamp() - entry.inserted > this.config.ttl) {\r\n      this.logger.debug(() => `Key is too old: ${key}`);\r\n      this.doEvict(key);\r\n    }\r\n  }\r\n\r\n  protected doEvict(key: K) {\r\n    this._stats.evict++;\r\n    this._entries.delete(key);\r\n  }\r\n\r\n  protected size() {\r\n    return this._entries.size;\r\n  }\r\n\r\n  protected cleanup() {\r\n    const numberOfEntriesToBeDeleted = Math.max(\r\n      0,\r\n      this.size() - this.config.maxSize\r\n    );\r\n    this.logger.debug(() => `Delete ${numberOfEntriesToBeDeleted} entries`);\r\n    const toBeDeleted = Array.from(this._entries.entries())\r\n      .sort((a, b) => a[1].inserted - b[1].inserted)\r\n      .slice(0, numberOfEntriesToBeDeleted);\r\n\r\n    toBeDeleted\r\n      .map(entry => {\r\n        this.logger.debug(() => `Cleanup: ${entry[0]}`);\r\n        return entry;\r\n      })\r\n      .forEach(entry => this.doEvict(entry[0]));\r\n  }\r\n\r\n  public stats(): string {\r\n    return `HITS: ${this._stats.hits} MISS: ${this._stats.miss} EVICT: ${this._stats.evict} SIZE: ${this._stats.size}`;\r\n  }\r\n\r\n  public resetStats(): void {\r\n    this._stats = new CacheStats();\r\n  }\r\n}\r\n\r\nexport class CacheManager {\r\n  private static _instance: CacheManager;\r\n\r\n  private logger = factory.getLogger(\"utils.Cache.CacheManager\");\r\n  private _caches: Map<string, Cache<string, any>> = new Map();\r\n\r\n  public static getInstance(): CacheManager {\r\n    if (!CacheManager._instance) {\r\n      CacheManager._instance = new CacheManager();\r\n    }\r\n    return CacheManager._instance;\r\n  }\r\n\r\n  public get(cache: string): Cache<string, any> {\r\n    if (!this._caches.has(cache)) {\r\n      this._caches.set(cache, new Cache());\r\n    }\r\n    return this._caches.get(cache) as Cache<string, any>;\r\n  }\r\n\r\n  public get caches(): Map<string, Cache<string, any>> {\r\n    return this._caches;\r\n  }\r\n}\r\n\r\nsetInterval(() => {\r\n  const logger = factory.getLogger(\"utils.Cache.stats\");\r\n\r\n  Array.from(CacheManager.getInstance().caches.entries()).forEach(cache => {\r\n    logger.info(\r\n      () => `CACHE STATS [${cache[0]}] ${cache[1].stats()} ${cache[1].config}`\r\n    );\r\n    cache[1].resetStats();\r\n  });\r\n}, 10000);\r\n","import { factory } from \"@/utils/ConfigLog4j\";\r\n\r\nconst durationsSize = 200;\r\nconst longCallThreshold = 5;\r\n\r\nclass StatsEntry {\r\n  protected _counter = 0;\r\n  protected _longCallsCounter = 0;\r\n  protected _durations: number[] = [];\r\n\r\n  public addDuration(duration: number) {\r\n    if (this._durations.length >= durationsSize) {\r\n      this._durations.shift();\r\n    }\r\n    this._durations.push(duration);\r\n    if (duration > longCallThreshold) {\r\n      this._longCallsCounter++;\r\n    }\r\n  }\r\n\r\n  public increaseCounter(): number {\r\n    return ++this._counter;\r\n  }\r\n\r\n  public get counter(): number {\r\n    return this._counter;\r\n  }\r\n\r\n  public durations(): number[] {\r\n    return this._durations;\r\n  }\r\n  public avg(): number {\r\n    const total = this._durations.reduce((acc, c) => acc + c, 0);\r\n    return total / this._durations.length;\r\n  }\r\n  public weight(): number {\r\n    return this.counter * this.avg();\r\n  }\r\n  public get longCalls(): number {\r\n    return this._longCallsCounter;\r\n  }\r\n}\r\n\r\nexport class StatsCollector {\r\n  private static _instance: StatsCollector;\r\n\r\n  private logger = factory.getLogger(\"utils.Stats.StatsCollector\");\r\n  private _entries: Map<string, StatsEntry> = new Map();\r\n\r\n  public static getInstance(): StatsCollector {\r\n    if (!StatsCollector._instance) {\r\n      StatsCollector._instance = new StatsCollector();\r\n    }\r\n    return StatsCollector._instance;\r\n  }\r\n\r\n  public static addEntry(key: string, duration: number) {\r\n    StatsCollector.getInstance().addEntry(key, duration);\r\n  }\r\n\r\n  public addEntry(key: string, duration: number) {\r\n    if (!this._entries.has(key)) {\r\n      this._entries.set(key, new StatsEntry());\r\n    }\r\n    const entry = this._entries.get(key) as StatsEntry;\r\n    entry.increaseCounter();\r\n    entry.addDuration(duration);\r\n  }\r\n\r\n  public resetEntry(key: string) {\r\n    this._entries.delete(key);\r\n  }\r\n\r\n  public get entries(): Map<string, StatsEntry> {\r\n    return this._entries;\r\n  }\r\n}\r\n\r\nsetInterval(() => {\r\n  if (StatsCollector.getInstance().entries.size == 0) {\r\n    return;\r\n  }\r\n  const logger = factory.getLogger(\"utils.Stats.stats\");\r\n\r\n  logger.info(\r\n    () =>\r\n      `Count\\t|\\tLong (>= ${longCallThreshold}ms)\\t|\\tAvg (ms)\\t|\\tWeight\\t|\\tName`\r\n  );\r\n  Array.from(StatsCollector.getInstance().entries.entries())\r\n    .sort((a, b) => a[1].weight() - b[1].weight())\r\n    .reverse()\r\n    .forEach(entry => {\r\n      logger.info(\r\n        () =>\r\n          `${entry[1].counter}\\t|\\t${\r\n            entry[1].longCalls\r\n          }\\t|\\t${entry[1]\r\n            .avg()\r\n            .toPrecision(4)}\\t|\\t${entry[1].weight().toPrecision(4)}\\t|\\t${\r\n            entry[0]\r\n          }`\r\n      );\r\n      StatsCollector.getInstance().resetEntry(entry[0]);\r\n    });\r\n}, 10000);\r\n","import { factory } from \"../utils/ConfigLog4j\";\r\nimport { CacheManager, CacheConfig } from \"./Cache\";\r\nimport { StatsCollector } from \"./Stats\";\r\n\r\n//ms\r\nconst loggerThreshold = 5;\r\n\r\nexport const timestamp = () =>\r\n  window.performance &&\r\n  window.performance.now &&\r\n  window.performance.timing &&\r\n  window.performance.timing.navigationStart\r\n    ? window.performance.now() + window.performance.timing.navigationStart\r\n    : Date.now();\r\n\r\nexport function stats(className?: string) {\r\n  const logger = factory.getLogger(\"utils.Decorators.stats\");\r\n\r\n  return function(target: any, key: string, descriptor: PropertyDescriptor) {\r\n    const originalMethod = descriptor.value;\r\n    const fullName = className != undefined ? `${className}.${key}` : key;\r\n    descriptor.value = function(...args: any[]) {\r\n      logger.debug(() => `Call ${fullName} start`);\r\n      const startTime = timestamp();\r\n      try {\r\n        const result = originalMethod.apply(this, args);\r\n        const duration = timestamp() - startTime;\r\n        logger.debug(() => `Call ${fullName} end [${duration}]`);\r\n        StatsCollector.addEntry(fullName, duration);\r\n        return result;\r\n      } catch (error) {\r\n        const duration = timestamp() - startTime;\r\n        logger.error(() => `Call ${fullName} failed [${duration}]`);\r\n        throw error;\r\n      }\r\n    };\r\n    return descriptor;\r\n  };\r\n}\r\n\r\nexport function cacheable(\r\n  name: string,\r\n  key: (args: any) => string = (args: any) => args,\r\n  config?: CacheConfig\r\n) {\r\n  const logger = factory.getLogger(\"utils.Decorators.cacheable\");\r\n  return function(\r\n    target: any,\r\n    methodName: string,\r\n    descriptor: PropertyDescriptor\r\n  ) {\r\n    const originalMethod = descriptor.value;\r\n    descriptor.value = function(...args: any[]) {\r\n      const cache = CacheManager.getInstance().get(name);\r\n      if (config) {\r\n        cache.config = config;\r\n      }\r\n      const entryKey = key(args);\r\n      const cachedValue = cache.get(entryKey);\r\n      if (typeof cachedValue !== \"undefined\") {\r\n        return cachedValue;\r\n      }\r\n      const result = originalMethod.apply(this, args);\r\n      cache.put(entryKey, result);\r\n      return result;\r\n    };\r\n    return descriptor;\r\n  };\r\n}\r\n","import { WorkContext } from \"../models/WorkContext\";\nimport { factory } from \"../utils/ConfigLog4j\";\nimport { Action } from \"@/models/Action\";\nimport { stats, cacheable } from \"@/utils/Decorators\";\nimport { CacheConfigFactory } from \"@/utils/Cache\";\nimport { ApplicationContext } from \"./ApplicationContext\";\nimport { Shift } from \"@/models/Shift\";\nimport { Employee } from \"@/models/Employee\";\n\nexport class WorkShiftService {\n  private logger = factory.getLogger(\"services.WorkShiftService\");\n\n  private actionService = ApplicationContext.getInstance().getActionService();\n  private dateService = ApplicationContext.getInstance().getDateService();\n\n  @stats(\"WorkShiftService.cached\")\n  @cacheable(\n    \"WorkShiftService.countByEmployeesDatesAction\",\n    (args: any[]) =>\n      args[0] + \"_\" + args[1].map((d: any) => d.toISOString()) + \"_\" + args[2],\n    new CacheConfigFactory().maxSize(2000).build()\n  )\n  @stats(\"WorkShiftService.raw\")\n  public countByEmployeesDatesAction(\n    employees: Array<number>,\n    dates: Array<Date>,\n    action: Action,\n    context: WorkContext\n  ): number {\n    return employees.flatMap(employeeId => {\n      return dates\n        .map(date => this.getAction(context, employeeId, date))\n        .filter(a => a == action);\n    }).length;\n  }\n\n  public countByEmployeesDatesActions(\n    employees: Array<number>,\n    dates: Array<Date>,\n    actions: Array<Action>,\n    context: WorkContext\n  ): number {\n    return actions\n      .map(action =>\n        this.countByEmployeesDatesAction(employees, dates, action, context)\n      )\n      .reduce((prev, curr) => prev + curr);\n  }\n\n  public hasEntry(\n    shifts: Array<Shift>,\n    employee: Employee,\n    date: Date\n  ): boolean {\n    return (\n      shifts\n        .filter(s => s.employeeId == employee.id)\n        .filter(s => s.date == date).length > 0\n    );\n  }\n\n  public getAction(\n    context: WorkContext,\n    employeeId: number,\n    date: Date\n  ): Action {\n    const label = context.getShift(\n      employeeId,\n      date,\n      this.actionService.getDefaultLabel()\n    );\n    return this.actionService.getAction(label);\n  }\n\n  rangeStart(date: Date): Date {\n    const startOfMonth = this.dateService.getStartOfMonth(date);\n    return this.dateService.getStartOfWeek(startOfMonth);\n  }\n\n  rangeEnd(date: Date): Date {\n    const endOfMonth = this.dateService.getEndOfMonth(date);\n    return this.dateService.getEndOfWeek(endOfMonth);\n  }\n\n  @stats(\"WorkShiftService\")\n  public isWeekendWorking(\n    employeeId: number,\n    day: Date,\n    context: WorkContext\n  ): boolean {\n    const sunday = this.dateService.getEndOfWeek(day);\n    const weekend = [this.dateService.addDays(sunday, -1), sunday];\n    const tot = this.countByEmployeesDatesActions(\n      [employeeId],\n      weekend,\n      [Action.MORNING, Action.AFTERNOON, Action.AWAY],\n      context\n    );\n    return tot > 0;\n  }\n\n  @stats(\"WorkShiftService\")\n  public isPreviousWeekendWorking(\n    employeeId: number,\n    day: Date,\n    context: WorkContext\n  ): boolean {\n    const monday = this.dateService.getStartOfWeek(day);\n    const weekend = [\n      this.dateService.addDays(monday, -2),\n      this.dateService.addDays(monday, -1)\n    ];\n    const tot = this.countByEmployeesDatesActions(\n      [employeeId],\n      weekend,\n      [Action.MORNING, Action.AFTERNOON, Action.AWAY],\n      context\n    );\n    return tot > 0;\n  }\n\n  public getExpectedEmployeeTotShiftsInWeek(\n    employeeId: number,\n    day: Date,\n    context: WorkContext\n  ): number {\n    const range = this.dateService.getWeek(day);\n\n    const employee = context.getEmployee(employeeId);\n    let expected = employee.totWeekShifts;\n    if (this.isWeekendWorking(employeeId, day, context)) {\n      expected++;\n    }\n    if (this.isPreviousWeekendWorking(employeeId, day, context)) {\n      expected--;\n    }\n    return expected;\n  }\n\n  public getExpectedEmployeeMorningShiftsInWeek(\n    employeeId: number,\n    day: Date,\n    context: WorkContext\n  ): number {\n    const range = this.dateService.getWeek(day);\n\n    const employee = context.getEmployee(employeeId);\n    let expected = employee.maxWeekMornings;\n    if (this.isWeekendWorking(employeeId, day, context)) {\n      expected++;\n    }\n    if (this.isPreviousWeekendWorking(employeeId, day, context)) {\n      expected--;\n    }\n    return expected;\n  }\n\n  public getExpectedEmployeeAfternoonShiftsInWeek(\n    employeeId: number,\n    day: Date,\n    context: WorkContext\n  ): number {\n    const employee = context.getEmployee(employeeId);\n    return employee.maxWeekAfternoons;\n  }\n}\n","import { WorkContext } from \"../models/WorkContext\";\r\nimport { factory } from \"../utils/ConfigLog4j\";\r\nimport { ApplicationContext } from \"./ApplicationContext\";\r\nimport { Action } from \"@/models/Action\";\r\nimport { Employee } from \"@/models/Employee\";\r\nimport { Group } from \"@/models/Group\";\r\nimport { stats } from \"@/utils/Decorators\";\r\n\r\nabstract class AbstractEmployeeShiftValidator {\r\n  protected dateService = ApplicationContext.getInstance().getDateService();\r\n  protected workShiftService = ApplicationContext.getInstance().getWorkShiftService();\r\n\r\n  public abstract errors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string>;\r\n}\r\n\r\nclass TotalShiftsPerWeek extends AbstractEmployeeShiftValidator {\r\n  private logger = factory.getLogger(\"services.TotalShiftsPerWeek\");\r\n\r\n  @stats(\"ShiftValidationService.TotalShiftsPerWeek\")\r\n  public errors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    const errors = new Array<string>();\r\n    if (employeeId == null) {\r\n      return errors;\r\n    }\r\n    const range = this.dateService.getWeek(day);\r\n\r\n    const tot = this.workShiftService.countByEmployeesDatesActions(\r\n      [employeeId],\r\n      range,\r\n      [Action.MORNING, Action.AFTERNOON, Action.AWAY],\r\n      context\r\n    );\r\n    const employee = context.getEmployee(employeeId);\r\n    const expected = this.workShiftService.getExpectedEmployeeTotShiftsInWeek(\r\n      employeeId,\r\n      day,\r\n      context\r\n    );\r\n    if (tot != expected) {\r\n      errors.push(\r\n        `${employee.name} dovrebbe lavorare ${expected} turni in una settimana, presenti ${tot}`\r\n      );\r\n    }\r\n    return errors;\r\n  }\r\n}\r\n\r\nclass MaxShiftByTypePerWeek extends AbstractEmployeeShiftValidator {\r\n  private logger = factory.getLogger(\"services.MinShiftPerWeek\");\r\n\r\n  @stats(\"ShiftValidationService.MaxShiftByTypePerWeek\")\r\n  public errors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    const errors = new Array<string>();\r\n    if (employeeId == null) {\r\n      return errors;\r\n    }\r\n    const range = this.dateService.getWeek(day);\r\n\r\n    const employee = context.getEmployee(employeeId);\r\n    const expectedMornings = this.workShiftService.getExpectedEmployeeMorningShiftsInWeek(\r\n      employeeId,\r\n      day,\r\n      context\r\n    );\r\n    const actualMornings = this.workShiftService.countByEmployeesDatesAction(\r\n      [employeeId],\r\n      range,\r\n      Action.MORNING,\r\n      context\r\n    );\r\n    const expectedAfternoons = this.workShiftService.getExpectedEmployeeAfternoonShiftsInWeek(\r\n      employeeId,\r\n      day,\r\n      context\r\n    );\r\n    const actualAfternoons = this.workShiftService.countByEmployeesDatesAction(\r\n      [employeeId],\r\n      range,\r\n      Action.AFTERNOON,\r\n      context\r\n    );\r\n    if (expectedMornings < actualMornings) {\r\n      errors.push(\r\n        `${employee.name} dovrebbe lavorare al massimo ${expectedMornings} mattine la settimana, presenti ${actualMornings}`\r\n      );\r\n    }\r\n    if (expectedAfternoons < actualAfternoons) {\r\n      errors.push(\r\n        `${employee.name} dovrebbe lavorare al massimo ${expectedAfternoons} pomeriggi la settimana, presenti ${actualAfternoons}`\r\n      );\r\n    }\r\n    return errors;\r\n  }\r\n}\r\n\r\nclass MaxCarsPerShift extends AbstractEmployeeShiftValidator {\r\n  private logger = factory.getLogger(\"services.MaxCarsPerShift\");\r\n  private action: Action;\r\n\r\n  public constructor(action: Action) {\r\n    super();\r\n    this.action = action;\r\n  }\r\n\r\n  @stats(\"ShiftValidationService.MaxCarsPerShift\")\r\n  public errors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    const errors = new Array<string>();\r\n\r\n    const employees = Array.from(context.employees.values()).map(\r\n      employee => employee.id\r\n    );\r\n\r\n    const tot = this.workShiftService.countByEmployeesDatesAction(\r\n      employees,\r\n      [day],\r\n      this.action,\r\n      context\r\n    );\r\n    if (tot > context.availableCars.total) {\r\n      if (this.action == Action.MORNING) {\r\n        errors.push(\r\n          `Disponibili ${context.availableCars.total} auto al mattino, assegnate ${tot}.`\r\n        );\r\n      }\r\n      if (this.action == Action.AFTERNOON) {\r\n        errors.push(\r\n          `Disponibili ${context.availableCars.total} auto al pomeriggio, assegnate ${tot}.`\r\n        );\r\n      }\r\n    }\r\n    return errors;\r\n  }\r\n}\r\n\r\nabstract class AbstractMinShiftsPerGroup {\r\n  protected dateService = ApplicationContext.getInstance().getDateService();\r\n  protected logger = factory.getLogger(\"services.AbstractMinShiftsPerGroup\");\r\n  protected workShiftService = ApplicationContext.getInstance().getWorkShiftService();\r\n\r\n  public errors(\r\n    groupId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    const errors = new Array<string>();\r\n    if (groupId == null) {\r\n      return errors;\r\n    }\r\n    const targetGroup = this.getGroup(groupId, context);\r\n    const dayOfWeek = this.dateService.getDayOfWeek(day);\r\n    if (typeof targetGroup === \"undefined\") {\r\n      return errors;\r\n    }\r\n\r\n    const employeeIdsInTargetGroup = Array.from(context.employees.values())\r\n      .filter(\r\n        employee =>\r\n          this.getGroupByEmployee(employee, context)?.id == targetGroup.id\r\n      )\r\n      .map(employee => employee.id);\r\n\r\n    const expectedMinMornings =\r\n      ApplicationContext.getInstance()\r\n        .getWeekConstraintService()\r\n        .getMinValue(targetGroup.constraints, dayOfWeek, Action.MORNING) || 0;\r\n    const actualMornings = this.workShiftService.countByEmployeesDatesAction(\r\n      employeeIdsInTargetGroup,\r\n      [day],\r\n      Action.MORNING,\r\n      context\r\n    );\r\n    const expectedMinAfternoons =\r\n      ApplicationContext.getInstance()\r\n        .getWeekConstraintService()\r\n        .getMinValue(targetGroup.constraints, dayOfWeek, Action.AFTERNOON) || 0;\r\n\r\n    const actualAfternoons = this.workShiftService.countByEmployeesDatesAction(\r\n      employeeIdsInTargetGroup,\r\n      [day],\r\n      Action.AFTERNOON,\r\n      context\r\n    );\r\n    if (expectedMinMornings > actualMornings) {\r\n      errors.push(\r\n        `Nel gruppo ${targetGroup.name} al mattino sono richieste almeno ${expectedMinMornings} risorse, presenti ${actualMornings}`\r\n      );\r\n    }\r\n    if (expectedMinAfternoons > actualAfternoons) {\r\n      errors.push(\r\n        `Nel gruppo ${targetGroup.name} al pomeriggio sono richieste almeno ${expectedMinAfternoons} risorse, presenti ${actualAfternoons}`\r\n      );\r\n    }\r\n    return errors;\r\n  }\r\n\r\n  protected abstract getGroup(\r\n    groupId: number,\r\n    context: WorkContext\r\n  ): Group | undefined;\r\n\r\n  protected abstract getGroupByEmployee(\r\n    employee: Employee,\r\n    context: WorkContext\r\n  ): Group | undefined;\r\n}\r\n\r\nclass MinShiftsPerGroup extends AbstractMinShiftsPerGroup {\r\n  @stats(\"ShiftValidationService.MinShiftsPerGroup\")\r\n  public errors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    return super.errors(employeeId, day, context);\r\n  }\r\n  protected getGroup(groupId: number, context: WorkContext): Group | undefined {\r\n    return context.getGroupById(groupId);\r\n  }\r\n\r\n  protected getGroupByEmployee(\r\n    employee: Employee,\r\n    context: WorkContext\r\n  ): Group | undefined {\r\n    return context.getGroupByEmployee(employee.id);\r\n  }\r\n}\r\nclass MinShiftsPerSubGroup extends AbstractMinShiftsPerGroup {\r\n  @stats(\"ShiftValidationService.MinShiftsPerSubGroup\")\r\n  public errors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    return super.errors(employeeId, day, context);\r\n  }\r\n\r\n  protected getGroup(groupId: number, context: WorkContext): Group | undefined {\r\n    return context.getSubgroupById(groupId);\r\n  }\r\n\r\n  protected getGroupByEmployee(\r\n    employee: Employee,\r\n    context: WorkContext\r\n  ): Group | undefined {\r\n    return context.getSubgroupByEmployee(employee.id);\r\n  }\r\n}\r\n\r\nexport class ShiftValidationService {\r\n  private logger = factory.getLogger(\"services.ShiftValidationService\");\r\n  protected dateService = ApplicationContext.getInstance().getDateService();\r\n\r\n  public getEmployeeErrors(\r\n    employeeId: number,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    return this.employeeErrors(employeeId, day, context, [\r\n      new TotalShiftsPerWeek(),\r\n      new MaxShiftByTypePerWeek(),\r\n      new MaxCarsPerShift(Action.MORNING),\r\n      new MaxCarsPerShift(Action.AFTERNOON)\r\n    ]);\r\n  }\r\n\r\n  public getGroupErrors(\r\n    groupId: number,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    return this.groupErrors(groupId, day, context, [new MinShiftsPerGroup()]);\r\n  }\r\n\r\n  public getSubgroupErrors(\r\n    groupId: number,\r\n    day: Date,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    return this.groupErrors(groupId, day, context, [\r\n      new MinShiftsPerSubGroup()\r\n    ]);\r\n  }\r\n\r\n  public getCarsErrors(\r\n    day: Date,\r\n    action: Action,\r\n    context: WorkContext\r\n  ): Array<string> {\r\n    return this.employeeErrors(null, day, context, [\r\n      new MaxCarsPerShift(action)\r\n    ]);\r\n  }\r\n\r\n  protected employeeErrors(\r\n    employeeId: number | null,\r\n    day: Date,\r\n    context: WorkContext,\r\n    validators: Array<AbstractEmployeeShiftValidator>\r\n  ): Array<string> {\r\n    const errors = validators.flatMap(validator =>\r\n      validator.errors(employeeId, day, context)\r\n    );\r\n    this.logger.debug(\r\n      () =>\r\n        `Validate employee ${employeeId} day ${this.dateService.format(\r\n          day\r\n        )} errors ${errors}`\r\n    );\r\n    return errors;\r\n  }\r\n\r\n  protected groupErrors(\r\n    groupId: number | null,\r\n    day: Date,\r\n    context: WorkContext,\r\n    validators: Array<AbstractMinShiftsPerGroup>\r\n  ): Array<string> {\r\n    const errors = validators.flatMap(validator =>\r\n      validator.errors(groupId, day, context)\r\n    );\r\n    this.logger.debug(\r\n      () =>\r\n        `Validate employee ${groupId} day ${this.dateService.format(\r\n          day\r\n        )} errors ${errors}`\r\n    );\r\n    return errors;\r\n  }\r\n}\r\n","import { DayOfWeek } from \"@/utils/DayOfWeek\";\r\nimport { Action } from \"@/models/Action\";\r\n\r\nexport const TYPE_MIN = \"min\";\r\n\r\nexport class WeekConstraint {\r\n  private _dayOfWeek: DayOfWeek = DayOfWeek.MONDAY;\r\n  private _action: Action = Action.IDLE;\r\n  private _type = \"\";\r\n  private _value = 0;\r\n\r\n  public constructor(\r\n    dayOfWeek: DayOfWeek,\r\n    action: Action,\r\n    value: number,\r\n    type: string\r\n  ) {\r\n    this.dayOfWeek = dayOfWeek;\r\n    this.action = action;\r\n    this.value = value;\r\n    this.type = type;\r\n  }\r\n\r\n  public static min(\r\n    dayOfWeek: DayOfWeek,\r\n    action: Action,\r\n    value: number\r\n  ): WeekConstraint {\r\n    return new WeekConstraint(dayOfWeek, action, value, TYPE_MIN);\r\n  }\r\n\r\n  public get dayOfWeek() {\r\n    return this._dayOfWeek;\r\n  }\r\n  public set dayOfWeek(dayOfWeek: DayOfWeek) {\r\n    this._dayOfWeek = dayOfWeek;\r\n  }\r\n  public get action() {\r\n    return this._action;\r\n  }\r\n  public set action(action: Action) {\r\n    this._action = action;\r\n  }\r\n  public get type() {\r\n    return this._type;\r\n  }\r\n  public set type(type: string) {\r\n    this._type = type;\r\n  }\r\n  public get value() {\r\n    return this._value;\r\n  }\r\n  public set value(value: number) {\r\n    this._value = value;\r\n  }\r\n\r\n  public clone(): WeekConstraint {\r\n    return new WeekConstraint(\r\n      this.dayOfWeek,\r\n      this.action,\r\n      this.value,\r\n      this.type\r\n    );\r\n  }\r\n}\r\n","import { WeekConstraint, TYPE_MIN } from \"@/models/WeekConstraint\";\r\nimport { DayOfWeek } from \"@/utils/DayOfWeek\";\r\nimport { Action } from \"@/models/Action\";\r\n\r\nexport class WeekConstraintService {\r\n  public entries(\r\n    constraints: Array<WeekConstraint>,\r\n    dayOfWeek?: DayOfWeek,\r\n    action?: Action,\r\n    type?: string\r\n  ): WeekConstraint[] {\r\n    return constraints\r\n      .filter(c => dayOfWeek != undefined && dayOfWeek == c.dayOfWeek)\r\n      .filter(c => action != undefined && action == c.action)\r\n      .filter(c => type != undefined && type == c.type);\r\n  }\r\n\r\n  public getMinValue(\r\n    constraints: Array<WeekConstraint>,\r\n    dayOfWeek: DayOfWeek,\r\n    action: Action\r\n  ): number | undefined {\r\n    const values = this.entries(constraints, dayOfWeek, action, TYPE_MIN);\r\n    if (values.length == 0) {\r\n      return undefined;\r\n    }\r\n    return values[0].value;\r\n  }\r\n}\r\n","import Vue from \"vue\";\nconst EventBus = new Vue();\nexport default EventBus;\n","import { factory } from \"@/utils/ConfigLog4j\";\nimport { timestamp } from \"@/utils/Decorators\";\nimport axios, { AxiosRequestConfig, AxiosResponse } from \"axios\";\nimport EventBus from \"./EventBus\";\n\nexport class WebService {\n  protected logger = factory.getLogger(\"utils.WebService\");\n\n  private _url = \"\";\n  private _method:\n    | \"get\"\n    | \"delete\"\n    | \"head\"\n    | \"options\"\n    | \"post\"\n    | \"put\"\n    | \"patch\"\n    | \"link\"\n    | \"unlink\"\n    | \"GET\"\n    | \"DELETE\"\n    | \"HEAD\"\n    | \"OPTIONS\"\n    | \"POST\"\n    | \"PUT\"\n    | \"PATCH\"\n    | \"LINK\"\n    | \"UNLINK\"\n    | undefined = undefined;\n  private _headers: any = {};\n  private _responseType:\n    | \"json\"\n    | \"arraybuffer\"\n    | \"blob\"\n    | \"document\"\n    | \"text\"\n    | \"stream\"\n    | undefined = \"json\";\n  private _spinner = true;\n\n  private _requestSerializer: (request: object) => any = (request: object) =>\n    JSON.stringify(request);\n\n  public url(url: string): WebService {\n    this._url = url;\n    return this;\n  }\n  public header(name: string, value: string): WebService {\n    this._headers[name] = value;\n    return this;\n  }\n  public responseType(\n    responseType:\n      | \"json\"\n      | \"arraybuffer\"\n      | \"blob\"\n      | \"document\"\n      | \"text\"\n      | \"stream\"\n      | undefined\n  ): WebService {\n    this._responseType = responseType;\n    return this;\n  }\n  public headerJson(): WebService {\n    this.header(\"Content-Type\", \"application/json; charset=utf-8\");\n    return this;\n  }\n  public method(\n    method:\n      | \"get\"\n      | \"delete\"\n      | \"head\"\n      | \"options\"\n      | \"post\"\n      | \"put\"\n      | \"patch\"\n      | \"link\"\n      | \"unlink\"\n      | \"GET\"\n      | \"DELETE\"\n      | \"HEAD\"\n      | \"OPTIONS\"\n      | \"POST\"\n      | \"PUT\"\n      | \"PATCH\"\n      | \"LINK\"\n      | \"UNLINK\"\n      | undefined\n  ): WebService {\n    this._method = method;\n    return this;\n  }\n  public get(): WebService {\n    return this.method(\"get\");\n  }\n  public post(): WebService {\n    return this.method(\"post\");\n  }\n  public requestSerializer(serializer: (request: object) => any): WebService {\n    this._requestSerializer = serializer;\n    return this;\n  }\n\n  public spinner(spinner: boolean): WebService {\n    this._spinner = spinner;\n    return this;\n  }\n\n  public call(payload: object) {\n    const startTime = timestamp();\n    const callName = this._url;\n    const instance = axios.create();\n\n    instance.interceptors.request.use((config: AxiosRequestConfig) => {\n      this.logger.debug(() => `Call ${config.url} start`);\n      return config;\n    });\n    instance.interceptors.response.use(\n      (response: AxiosResponse<any>) => {\n        const duration = timestamp() - startTime;\n        this.logger.info(\n          () =>\n            `Call ${response.config.url} end [${duration}] status [${response.status}] ${response.statusText}`\n        );\n        return response;\n      },\n      (error: any) => {\n        const duration = timestamp() - startTime;\n        this.logger.error(\n          () => `Call ${error.config.url} failed [${duration}]`\n        );\n        throw { data: error.response.data };\n      }\n    );\n\n    instance.interceptors.request.use((config: AxiosRequestConfig) => {\n      if (this._spinner) {\n        EventBus.$emit(\"ASYNC_ACTION_START\", callName);\n      }\n      return config;\n    });\n\n    instance.interceptors.response.use(\n      (response: AxiosResponse<any>) => {\n        if (this._spinner) {\n          EventBus.$emit(\"ASYNC_ACTION_END\", `${callName} ok`);\n        }\n        return response;\n      },\n      (error: any) => {\n        if (this._spinner) {\n          EventBus.$emit(\"ASYNC_ACTION_END\", `${callName} ko`);\n        }\n        throw error;\n      }\n    );\n\n    return instance({\n      url: this._url,\n      method: this._method,\n      headers: this._headers,\n      responseType: this._responseType,\n      data: this._requestSerializer(payload)\n    });\n  }\n}\n\nexport class BackendWebService extends WebService {\n  private configs = [\n    {\n      env: \"test\",\n      frontendUrls: [\"http://localhost:8080\"],\n      backendUrl: \"http://localhost:8081\"\n    },\n    {\n      env: \"prod\",\n      frontendUrls: [\"http://vitalegi.ovh:3000\", \"https://vitalegi.ovh:3000\"],\n      backendUrl: \"https://vitalegi.ovh:3000\"\n    }\n  ];\n\n  public url(url: string): WebService {\n    const fullUrl = this.getBackendUrl() + url;\n    this.logger.debug(\n      () =>\n        `BackendURL: ${this.getBackendUrl()} URL: ${url} WindowLocation: ${\n          window.location\n        }`\n    );\n    return super.url(fullUrl);\n  }\n  protected getBackendUrl(): string {\n    const url = this.getCurrentUrl();\n    const configs = this.configs.filter(\n      cfg =>\n        cfg.frontendUrls.filter(frontendUrl => frontendUrl == url).length > 0\n    );\n    if (configs.length == 1) {\n      return configs[0].backendUrl;\n    }\n    this.logger.error(\n      () => `Unrecognized environment: ${url}. Fallback to default.`\n    );\n    return url;\n  }\n  protected getCurrentUrl(): string {\n    return (\n      location.protocol +\n      \"//\" +\n      location.hostname +\n      (location.port ? \":\" + location.port : \"\")\n    );\n  }\n}\n","export interface Notification {\r\n  title: string;\r\n  message: string;\r\n}\r\n\r\nexport class ErrorNotification implements Notification {\r\n  public title = \"\";\r\n  public message = \"\";\r\n  public wsError: any;\r\n\r\n  constructor(title: string, message: string, wsError?: any) {\r\n    this.title = title;\r\n    this.message = message;\r\n    this.wsError = wsError;\r\n  }\r\n}\r\n\r\nexport class GlobalNotification<E extends Notification> {\r\n  private notifications = new Array<E>();\r\n\r\n  public add(notification: E) {\r\n    this.notifications.push(notification);\r\n  }\r\n  public count(): number {\r\n    return this.notifications.length;\r\n  }\r\n  public has(): boolean {\r\n    return this.notifications.length > 0;\r\n  }\r\n  public pop(): E {\r\n    if (!this.has()) {\r\n      throw new Error(`Empty list`);\r\n    }\r\n    return this.notifications.splice(0, 1)[0];\r\n  }\r\n  public get(): E {\r\n    if (!this.has()) {\r\n      throw new Error(`Empty list`);\r\n    }\r\n    return this.notifications[0];\r\n  }\r\n}\r\n","import { factory } from \"@/utils/ConfigLog4j\";\nimport { WorkContext } from \"@/models/WorkContext\";\nimport { stats } from \"@/utils/Decorators\";\nimport { ApplicationContext } from \"./ApplicationContext\";\nimport { Action } from \"@/models/Action\";\nimport { Employee } from \"@/models/Employee\";\nimport { Group } from \"@/models/Group\";\nimport { BackendWebService } from \"@/utils/WebService\";\nimport { ErrorNotification } from '@/utils/GlobalNotification';\n\nconst logger = factory.getLogger(\"services.OptimizeShiftsService\");\n\nconst MAX_INTEGER = 2147483647;\n\nclass Variable {\n  public name = \"\";\n  public min = 0;\n  public max = 0;\n\n  constructor(name: string, min: number, max: number) {\n    this.name = name;\n    this.min = min;\n    this.max = max;\n  }\n}\n\nclass Coefficient {\n  public variable: Variable;\n  public coefficient: number;\n\n  constructor(variable: Variable, coefficient: number) {\n    this.variable = variable;\n    this.coefficient = coefficient;\n  }\n}\nclass Objective {\n  private _name: string;\n  private _coefficient: number;\n\n  constructor(name: string, coefficient: number) {\n    this._name = name;\n    this._coefficient = coefficient;\n  }\n  public get name() {\n    return this._name;\n  }\n  public get coefficient() {\n    return this._coefficient;\n  }\n}\nclass SolutionVariable {\n  public name = \"\";\n  public value = 0;\n}\nclass Constraint {\n  public context: OptimizationContext;\n  public name = \"\";\n  public min = 0;\n  public max = 0;\n  public coefficients: Array<Coefficient>;\n\n  constructor(\n    context: OptimizationContext,\n    name: string,\n    min: number,\n    max: number,\n    coefficients: Array<Coefficient> = []\n  ) {\n    this.context = context;\n    this.name = name;\n    this.min = min;\n    this.max = max;\n    this.coefficients = coefficients;\n  }\n\n  public addCoefficient(variable: string, coefficient: number): Constraint {\n    if (this.coefficients.filter(c => c.variable.name == variable).length > 0) {\n      throw new Error(\n        `Cannot add coefficient ${variable} to constraint ${name}. Coefficient already exists.`\n      );\n    }\n    this.coefficients.push(\n      new Coefficient(this.context.getVariable(variable), coefficient)\n    );\n    return this;\n  }\n}\n\nconst constraintToString = (constraint: Constraint) => {\n  const coefficients = constraint.coefficients\n    .map(c => `${c.variable.name} [${c.coefficient}]`)\n    .reduce((prev, curr) => prev + \"\\n -- \" + curr, \"\");\n  return `${constraint.name}, min/max: ${constraint.min}/${constraint.max}. coefficients:${coefficients}`;\n};\n\nconst format = (date: Date) => {\n  const dateService = ApplicationContext.getInstance().getDateService();\n  const dayOfWeek = dateService.getDayOfWeekName(\n    dateService.getDayOfWeek(date)\n  );\n  return dateService.format(date) + \"_\" + dayOfWeek;\n};\n\nconst variable = (employeeId: number, date: Date, action: Action) => {\n  const dateFormatted = format(date);\n  const actionName = ApplicationContext.getInstance()\n    .getActionService()\n    .getActionName(action);\n  return `${employeeId}_${dateFormatted}_${actionName}`;\n};\n\nclass OptimizationContext {\n  protected variables = new Map<string, Variable>();\n  protected constraints = new Map<string, Constraint>();\n  protected objectives = new Array<Objective>();\n\n  public addVariable(name: string, min: number, max: number): Variable {\n    logger.debug(() => `addVariable [${name}] ${min}/${max}`);\n    if (this.variables.has(name)) {\n      throw new Error(`Variable ${name} already exists.`);\n    }\n    const v = new Variable(name, min, max);\n    this.variables.set(name, v);\n    return v;\n  }\n  public addConstraint(\n    name: string,\n    min: number,\n    max: number,\n    coefficients: Array<Coefficient> = []\n  ): Constraint {\n    logger.debug(() => `addConstraint [${name}] ${min}/${max}`);\n    if (this.constraints.has(name)) {\n      throw new Error(`Constraint [${name}] already exists.`);\n    }\n    const c = new Constraint(this, name, min, max, coefficients);\n    this.constraints.set(name, c);\n    return c;\n  }\n  public getVariable(name: string): Variable {\n    const v = this.variables.get(name);\n    if (v) {\n      return v;\n    }\n    throw new Error(`Variable [${name}] doesn't exist.`);\n  }\n  public getConstraint(name: string): Constraint {\n    const c = this.constraints.get(name);\n    if (c) {\n      return c;\n    }\n    throw new Error(`Constraint [${name}] doesn't exist.`);\n  }\n  public hasVariable(name: string): boolean {\n    return this.variables.has(name);\n  }\n  public hasConstraint(name: string): boolean {\n    return this.constraints.has(name);\n  }\n  public variableNames(): Array<string> {\n    return Array.from(this.variables.entries()).map(e => e[0]);\n  }\n  public constraintNames(): Array<string> {\n    return Array.from(this.constraints.entries()).map(e => e[0]);\n  }\n  public variableValues(): Array<Variable> {\n    return Array.from(this.variables.values());\n  }\n  public constraintValues(): Array<Constraint> {\n    return Array.from(this.constraints.values());\n  }\n  public addObjectiveCoefficient(variable: string, coefficient: number): void {\n    this.objectives.push(new Objective(variable, coefficient));\n  }\n  public getObjectives() {\n    return this.objectives;\n  }\n}\n\nclass OptimizationContextSerializer {\n  public serialize(context: OptimizationContext): object {\n    const outCtx = {\n      variables: context.variableValues().map(v => this.serializeVariable(v)),\n      constraints: context\n        .constraintValues()\n        .map(c => this.serializeConstraint(c)),\n      objective: context.getObjectives().map(o => this.serializeObjective(o))\n    };\n    return outCtx;\n  }\n\n  protected serializeVariable(variable: Variable): object {\n    return {\n      name: variable.name,\n      max: variable.max,\n      min: variable.min\n    };\n  }\n  protected serializeConstraint(constraint: Constraint): object {\n    return {\n      name: constraint.name,\n      max: constraint.max,\n      min: constraint.min,\n      coefficients: constraint.coefficients.map(c =>\n        this.serializeCoefficient(c)\n      )\n    };\n  }\n  protected serializeCoefficient(coefficient: Coefficient): object {\n    const obj = this.serializeVariable(coefficient.variable);\n    (obj as any).coefficient = coefficient.coefficient;\n    return obj;\n  }\n  protected serializeObjective(objective: Objective): object {\n    return {\n      name: objective.name,\n      coefficient: objective.coefficient\n    };\n  }\n}\n\nclass EmployeeVariable {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private workShiftService = ApplicationContext.getInstance().getWorkShiftService();\n\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    employeeId: number,\n    date: Date\n  ): void {\n    logger.debug(\n      () =>\n        `EmployeeVariable employeeId[${employeeId}] date[${this.dateService.format(\n          date\n        )}]`\n    );\n    const action = this.workShiftService.getAction(context, employeeId, date);\n    if (action == Action.IDLE) {\n      if (this.dateService.isWeekend(this.dateService.getDayOfWeek(date))) {\n        this.addVariable(opt, employeeId, date, Action.MORNING, 0, 0);\n        this.addVariable(opt, employeeId, date, Action.AFTERNOON, 0, 0);\n        this.addVariable(opt, employeeId, date, Action.AWAY, 0, 0);\n        this.addVariable(opt, employeeId, date, Action.IDLE, 0, 0);\n      } else {\n        this.addVariable(opt, employeeId, date, Action.MORNING, 0, 1);\n        this.addVariable(opt, employeeId, date, Action.AFTERNOON, 0, 1);\n        this.addVariable(opt, employeeId, date, Action.AWAY, 0, 0);\n        this.addVariable(opt, employeeId, date, Action.IDLE, 0, 1);\n      }\n    }\n    if (action == Action.MORNING) {\n      this.addVariable(opt, employeeId, date, Action.MORNING, 1, 1);\n      this.addVariable(opt, employeeId, date, Action.AFTERNOON, 0, 0);\n      this.addVariable(opt, employeeId, date, Action.AWAY, 0, 0);\n      this.addVariable(opt, employeeId, date, Action.IDLE, 0, 0);\n    }\n    if (action == Action.AFTERNOON) {\n      this.addVariable(opt, employeeId, date, Action.MORNING, 0, 0);\n      this.addVariable(opt, employeeId, date, Action.AFTERNOON, 1, 1);\n      this.addVariable(opt, employeeId, date, Action.AWAY, 0, 0);\n      this.addVariable(opt, employeeId, date, Action.IDLE, 0, 0);\n    }\n    if (action == Action.AWAY) {\n      this.addVariable(opt, employeeId, date, Action.MORNING, 0, 0);\n      this.addVariable(opt, employeeId, date, Action.AFTERNOON, 0, 0);\n      this.addVariable(opt, employeeId, date, Action.AWAY, 1, 1);\n      this.addVariable(opt, employeeId, date, Action.IDLE, 0, 0);\n    }\n  }\n\n  protected addVariable(\n    opt: OptimizationContext,\n    employeeId: number,\n    date: Date,\n    action: Action,\n    min: number,\n    max: number\n  ): void {\n    const name = variable(employeeId, date, action);\n    logger.debug(\n      () =>\n        `EmployeeVariable employeeId[${employeeId}] date[${this.dateService.format(\n          date\n        )}] action[${action}] variable[${name}] ${min}/${max}`\n    );\n    opt.addVariable(name, min, max);\n  }\n}\n\nclass EmployeeDailyConstraint {\n  private dateService = ApplicationContext.getInstance().getDateService();\n\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    employeeId: number,\n    date: Date\n  ): void {\n    logger.debug(\n      () =>\n        `EmployeeDailyConstraint employeeId[${employeeId}] date[${this.dateService.format(\n          date\n        )}]`\n    );\n    const constraint = opt.addConstraint(\n      this.oneActivityPerDay(employeeId, date),\n      0,\n      1\n    );\n    constraint\n      .addCoefficient(variable(employeeId, date, Action.MORNING), 1)\n      .addCoefficient(variable(employeeId, date, Action.AFTERNOON), 1)\n      .addCoefficient(variable(employeeId, date, Action.AWAY), 1)\n      .addCoefficient(variable(employeeId, date, Action.IDLE), 1);\n\n    logger.debug(\n      () =>\n        `EmployeeDailyConstraint employeeId[${employeeId}] date[${this.dateService.format(\n          date\n        )}] ==> ${constraintToString(constraint)}`\n    );\n  }\n\n  protected oneActivityPerDay(employeeId: number, date: Date): string {\n    return `${employeeId}_${format(date)}_one_activity_per_day`;\n  }\n}\nclass EmployeeWeeklyTotConstraint {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private workShiftService = ApplicationContext.getInstance().getWorkShiftService();\n\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    employeeId: number,\n    week: Array<Date>\n  ): void {\n    logger.debug(\n      () =>\n        `EmployeeWeeklyTotConstraint employeeId[${employeeId}] dates[${week.map(\n          date => this.dateService.format(date)\n        )}]`\n    );\n    const expectedTot = this.workShiftService.getExpectedEmployeeTotShiftsInWeek(\n      employeeId,\n      week[0],\n      context\n    );\n    const tot = opt.addConstraint(\n      this.employeeWeeklyTotActivities(employeeId, week),\n      0,\n      expectedTot\n    );\n    week.forEach(day => {\n      tot.addCoefficient(variable(employeeId, day, Action.MORNING), 1);\n      tot.addCoefficient(variable(employeeId, day, Action.AFTERNOON), 1);\n    });\n    logger.debug(\n      () =>\n        `EmployeeWeeklyTotConstraint employeeId[${employeeId}] dates[${week.map(\n          date => this.dateService.format(date)\n        )}] ==> ${constraintToString(tot)}`\n    );\n  }\n  protected employeeWeeklyTotActivities(\n    employeeId: number,\n    week: Array<Date>\n  ): string {\n    return `${employeeId}_${format(week[0])}_tot_activities_per_week`;\n  }\n}\n\nclass EmployeeWeeklyMorningsConstraint {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private workShiftService = ApplicationContext.getInstance().getWorkShiftService();\n\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    employeeId: number,\n    week: Array<Date>\n  ): void {\n    logger.debug(\n      () =>\n        `EmployeeWeeklyMorningsConstraint employeeId[${employeeId}] dates[${week.map(\n          date => this.dateService.format(date)\n        )}]`\n    );\n    const expectedMornings = this.workShiftService.getExpectedEmployeeMorningShiftsInWeek(\n      employeeId,\n      week[0],\n      context\n    );\n    const morning = opt.addConstraint(\n      this.employeeWeeklyMorningActivities(employeeId, week),\n      0,\n      expectedMornings\n    );\n    week.forEach(day => {\n      morning.addCoefficient(variable(employeeId, day, Action.MORNING), 1);\n    });\n    logger.debug(\n      () =>\n        `EmployeeWeeklyMorningsConstraint employeeId[${employeeId}] dates[${week.map(\n          date => this.dateService.format(date)\n        )}] ==> ${constraintToString(morning)}`\n    );\n  }\n  protected employeeWeeklyMorningActivities(\n    employeeId: number,\n    week: Array<Date>\n  ): string {\n    return `${employeeId}_${format(week[0])}_morning_activities_per_week`;\n  }\n}\n\nclass EmployeeWeeklyAfternoonsConstraint {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private workShiftService = ApplicationContext.getInstance().getWorkShiftService();\n\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    employeeId: number,\n    week: Array<Date>\n  ): void {\n    logger.debug(\n      () =>\n        `EmployeeWeeklyAfternoonsConstraint employeeId[${employeeId}] dates[${week.map(\n          date => this.dateService.format(date)\n        )}]`\n    );\n    const expectedAfternoons = this.workShiftService.getExpectedEmployeeAfternoonShiftsInWeek(\n      employeeId,\n      week[0],\n      context\n    );\n    const afternoon = opt.addConstraint(\n      this.employeeWeeklyAfternoonActivities(employeeId, week),\n      0,\n      expectedAfternoons\n    );\n    week.forEach(day => {\n      afternoon.addCoefficient(variable(employeeId, day, Action.AFTERNOON), 1);\n    });\n    logger.debug(\n      () =>\n        `EmployeeWeeklyAfternoonsConstraint employeeId[${employeeId}] dates[${week.map(\n          date => this.dateService.format(date)\n        )}] ==> ${constraintToString(afternoon)}`\n    );\n  }\n  protected employeeWeeklyAfternoonActivities(\n    employeeId: number,\n    week: Array<Date>\n  ): string {\n    return `${employeeId}_${format(week[0])}_afternoon_activities_per_week`;\n  }\n}\n\nclass CarsDailyConstraint {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private actionService = ApplicationContext.getInstance().getActionService();\n  private _action: Action;\n\n  constructor(action: Action) {\n    this._action = action;\n  }\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    date: Date\n  ): void {\n    logger.debug(\n      () =>\n        `CarsDailyConstraint date[${this.dateService.format(\n          date\n        )}] action[${this.actionService.getActionName(this._action)}]`\n    );\n    const expected = context.availableCars.total;\n\n    const constraint = opt.addConstraint(\n      this.carsDailyActivities(date, this._action),\n      0,\n      expected\n    );\n    const employees = Array.from(context.employees.values());\n\n    employees\n      .map(e => e.id)\n      .forEach(employeeId => {\n        constraint.addCoefficient(variable(employeeId, date, this._action), 1);\n      });\n    logger.debug(\n      () =>\n        `CarsDailyConstraint date[${this.dateService.format(\n          date\n        )}] action[${this.actionService.getActionName(\n          this._action\n        )}] ==> ${constraintToString(constraint)}`\n    );\n  }\n  protected carsDailyActivities(date: Date, action: Action) {\n    const actionName = this.actionService.getActionName(action);\n    return `cars_${format(date)}_${actionName}`;\n  }\n}\n\nabstract class AbstractGroupDailyConstraint {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private actionService = ApplicationContext.getInstance().getActionService();\n  private weekConstraintService = ApplicationContext.getInstance().getWeekConstraintService();\n  private _action: Action;\n\n  constructor(action: Action) {\n    this._action = action;\n  }\n\n  public apply(\n    context: WorkContext,\n    opt: OptimizationContext,\n    groupId: number,\n    date: Date\n  ): void {\n    const employeeIds = this.getEmployeeIdsInGroup(context, groupId);\n    const group = this.getGroup(context, groupId);\n    if (this.dateService.isWeekend(this.dateService.getDayOfWeek(date))) {\n      logger.debug(\n        () =>\n          `AbstractGroupDailyConstraint groupId[${groupId}][${\n            group.name\n          }] dates[${this.dateService.format(date)}] ${employeeIds.map(\n            id => `employeeId[${id}], is a weekend, skip constraint.`\n          )}`\n      );\n      return;\n    }\n    logger.debug(\n      () =>\n        `AbstractGroupDailyConstraint groupId[${groupId}][${\n          group.name\n        }] dates[${this.dateService.format(date)}] ${employeeIds.map(\n          id => `employeeId[${id}]`\n        )}`\n    );\n    const expectedMin = this.getExpectedMin(group, date);\n    const constraint = opt.addConstraint(\n      this.getConstraintName(groupId, date, this._action),\n      expectedMin,\n      MAX_INTEGER\n    );\n    employeeIds.forEach(employeeId => {\n      constraint.addCoefficient(variable(employeeId, date, this._action), 1);\n    });\n    logger.debug(\n      () =>\n        `AbstractGroupDailyConstraint groupId[${groupId}][${\n          group.name\n        }] dates[${this.dateService.format(date)}] ${employeeIds.map(\n          id => `employeeId[${id}]`\n        )} ==> ${constraintToString(constraint)}`\n    );\n  }\n\n  protected abstract getEmployeeIdsInGroup(\n    context: WorkContext,\n    groupId: number\n  ): Array<number>;\n\n  protected abstract getGroup(context: WorkContext, groupId: number): Group;\n\n  protected abstract getConstraintName(\n    groupId: number,\n    date: Date,\n    action: Action\n  ): string;\n\n  protected getExpectedMin(group: Group, date: Date): number {\n    const dayOfWeek = this.dateService.getDayOfWeek(date);\n    return (\n      this.weekConstraintService.getMinValue(\n        group.constraints,\n        dayOfWeek,\n        this._action\n      ) || 0\n    );\n  }\n  protected groupDailyActivities(\n    type: string,\n    groupId: number,\n    date: Date,\n    action: Action\n  ): string {\n    const actionName = this.actionService.getActionName(action);\n    return `${type}_${groupId}_${format(date)}_${actionName}`;\n  }\n}\nclass GroupDailyConstraint extends AbstractGroupDailyConstraint {\n  protected getEmployeeIdsInGroup(\n    context: WorkContext,\n    groupId: number\n  ): number[] {\n    return Array.from(context.employees.values())\n      .map(employee => employee.id)\n      .filter(\n        employeeId => context.getGroupByEmployee(employeeId)?.id == groupId\n      );\n  }\n  protected getGroup(context: WorkContext, groupId: number): Group {\n    const group = context.getGroupById(groupId);\n    if (group) {\n      return group;\n    }\n    throw new Error(`Group ${groupId} doesn't exist`);\n  }\n  protected getConstraintName(\n    groupId: number,\n    date: Date,\n    action: Action\n  ): string {\n    return super.groupDailyActivities(\"GROUP\", groupId, date, action);\n  }\n}\nclass SubgroupDailyConstraint extends AbstractGroupDailyConstraint {\n  protected getEmployeeIdsInGroup(\n    context: WorkContext,\n    groupId: number\n  ): number[] {\n    return Array.from(context.employees.values())\n      .map(employee => employee.id)\n      .filter(\n        employeeId => context.getSubgroupByEmployee(employeeId)?.id == groupId\n      );\n  }\n  protected getGroup(context: WorkContext, groupId: number): Group {\n    const group = context.getSubgroupById(groupId);\n    if (group) {\n      return group;\n    }\n    throw new Error(`Subgroup ${groupId} doesn't exist`);\n  }\n  protected getConstraintName(\n    groupId: number,\n    date: Date,\n    action: Action\n  ): string {\n    return super.groupDailyActivities(\"SUBGROUP\", groupId, date, action);\n  }\n}\nexport class OptimizeShiftsService {\n  private dateService = ApplicationContext.getInstance().getDateService();\n  private workShiftService = ApplicationContext.getInstance().getWorkShiftService();\n  private actionService = ApplicationContext.getInstance().getActionService();\n\n  @stats(\"OptimizeShiftsService\")\n  public optimize(context: WorkContext): void {\n    const opt = this.createOptimizationContext(context);\n    const serializer = new OptimizationContextSerializer();\n\n    new BackendWebService()\n      .url(\"/workshifts-rest/optimize\")\n      .post()\n      .headerJson()\n      .call(serializer.serialize(opt))\n      .then(response => {\n        const solutions: SolutionVariable[] = response.data;\n        const fastSolutions = new Map<string, number>();\n        solutions.forEach(solution =>\n          fastSolutions.set(solution.name, solution.value)\n        );\n\n        this.validateSolutions(context, fastSolutions);\n        this.range(context.date).forEach(date => {\n          context.sortedEmployees().forEach(employeeId => {\n            this.updateContext(context, fastSolutions, employeeId, date);\n          });\n        });\n      })\n      .catch(error => {\n        ApplicationContext.getInstance()\n          .getErrorNotifications()\n          .add(new ErrorNotification(\"Error\", \"Error optimizing shift\"));\n      });\n  }\n  @stats(\"OptimizeShiftsService\")\n  protected createOptimizationContext(\n    context: WorkContext\n  ): OptimizationContext {\n    const opt = new OptimizationContext();\n\n    const range = this.range(context.date);\n    const weeks = this.dateService.getWeeks(range);\n\n    range.forEach(date => {\n      context.sortedEmployees().forEach(employeeId => {\n        new EmployeeVariable().apply(context, opt, employeeId, date);\n        new EmployeeDailyConstraint().apply(context, opt, employeeId, date);\n      });\n    });\n\n    weeks.forEach(week => {\n      context.sortedEmployees().forEach(employeeId => {\n        new EmployeeWeeklyTotConstraint().apply(context, opt, employeeId, week);\n        new EmployeeWeeklyMorningsConstraint().apply(\n          context,\n          opt,\n          employeeId,\n          week\n        );\n        new EmployeeWeeklyAfternoonsConstraint().apply(\n          context,\n          opt,\n          employeeId,\n          week\n        );\n      });\n    });\n\n    const groupsDailyConstraints = [\n      new GroupDailyConstraint(Action.MORNING),\n      new GroupDailyConstraint(Action.AFTERNOON)\n    ];\n    range.forEach(date => {\n      context.groups.forEach(group => {\n        groupsDailyConstraints.forEach(constraint => {\n          constraint.apply(context, opt, group.id, date);\n        });\n      });\n    });\n\n    const subgroupsDailyConstraints = [\n      new SubgroupDailyConstraint(Action.MORNING),\n      new SubgroupDailyConstraint(Action.AFTERNOON)\n    ];\n\n    range.forEach(date => {\n      context.subgroups.forEach(group => {\n        subgroupsDailyConstraints.forEach(constraint => {\n          constraint.apply(context, opt, group.id, date);\n        });\n      });\n    });\n\n    const carsConstraints = [\n      new CarsDailyConstraint(Action.MORNING),\n      new CarsDailyConstraint(Action.AFTERNOON)\n    ];\n    range.forEach(date => {\n      carsConstraints.forEach(constraint => {\n        constraint.apply(context, opt, date);\n      });\n    });\n\n    [Action.MORNING, Action.AFTERNOON].forEach(action =>\n      range.forEach(date => {\n        context.sortedEmployees().forEach(employeeId => {\n          opt.addObjectiveCoefficient(variable(employeeId, date, action), 1);\n        });\n      })\n    );\n\n    if (logger.isDebugEnabled()) {\n      opt.constraintNames().forEach(constraintName => {\n        const constraint = opt.getConstraint(constraintName);\n        const coefficients = constraint.coefficients\n          .map(c => `${c.variable.name} [${c.coefficient}]`)\n          .reduce((prev, curr) => prev + \"\\n -- \" + curr, \"\");\n        logger.debug(\n          () =>\n            `C: ${constraint.name}, min/max: ${constraint.min}/${constraint.max}. coefficients:${coefficients}`\n        );\n      });\n      opt.getObjectives().forEach(objective => {\n        logger.debug(() => `O: ${objective.name} ${objective.coefficient}`);\n      });\n    }\n    logger.info(\n      () =>\n        `Optimize ${opt.variableNames().length} variables and ${\n          opt.constraintNames().length\n        } constraints`\n    );\n    return opt;\n  }\n  @stats(\"OptimizeShiftsService\")\n  protected updateContext(\n    context: WorkContext,\n    solutions: Map<string, number>,\n    employeeId: number,\n    date: Date\n  ) {\n    const selected = this.actionService\n      .getActions()\n      .map(action => {\n        const value = this.getSolution(solutions, employeeId, date, action);\n        return [action, value];\n      })\n      .filter(e => e[1] == 1)\n      .map(e => e[0]);\n    const newAction = selected.length == 1 ? selected[0] : Action.IDLE;\n    const currAction = this.actionService.getAction(\n      context.getShift(employeeId, date)\n    );\n    if (newAction != currAction) {\n      logger.debug(\n        () =>\n          `Optimization output, update shift employeeId ${employeeId}, date ${this.dateService.format(\n            date\n          )}, ${this.actionService.getActionName(\n            currAction\n          )} ==> ${this.actionService.getActionName(newAction)}`\n      );\n      context.setShift(\n        employeeId,\n        date,\n        this.actionService.getLabels(newAction)[0]\n      );\n    }\n  }\n  @stats(\"OptimizeShiftsService\")\n  protected validateSolutions(\n    context: WorkContext,\n    solutions: Map<string, number>\n  ) {\n    const range = this.range(context.date);\n    const employees = context.sortedEmployees();\n    const actions = this.actionService.getActions();\n\n    range.forEach(date => {\n      employees.forEach(employeeId => {\n        const values = new Map<Action, number>();\n        actions.forEach(action => {\n          const value = this.getSolution(solutions, employeeId, date, action);\n          if (value != 0 && value != 1) {\n            throw Error(\n              `employeeId ${employeeId} date ${this.dateService.format(\n                date\n              )} action ${this.actionService.getActionName(\n                action\n              )}, invalid value: ${value}, expected 0 or 1.`\n            );\n          }\n          values.set(action, value);\n        });\n        const selected = Array.from(values.entries())\n          .filter(e => e[1] == 1)\n          .map(e => e[0]);\n        if (selected.length > 1) {\n          throw Error(\n            `employeeId ${employeeId} date ${this.dateService.format(\n              date\n            )}, more than one selection.`\n          );\n        }\n      });\n    });\n  }\n\n  @stats(\"OptimizeShiftsService\")\n  protected getSolution(\n    solutions: Map<string, number>,\n    employeeId: number,\n    date: Date,\n    action: Action\n  ): number {\n    const key = variable(employeeId, date, action);\n    if (solutions.has(key)) {\n      return solutions.get(key) as number;\n    }\n    logger.info(\n      () =>\n        `employeeId ${employeeId} date ${this.dateService.format(\n          date\n        )} action ${this.actionService.getActionName(\n          action\n        )} doesn't exist in the solution`\n    );\n    return 0;\n  }\n  protected range(date: Date): Array<Date> {\n    return this.dateService.range(this.rangeStart(date), this.rangeEnd(date));\n  }\n  protected rangeStart(date: Date): Date {\n    return this.workShiftService.rangeStart(date);\n  }\n  protected rangeEnd(date: Date): Date {\n    return this.workShiftService.rangeEnd(date);\n  }\n}\n","import { ActionService } from \"@/services/ActionService\";\nimport { DateService } from \"@/services/DateService\";\nimport { WorkShiftService } from \"@/services/WorkShiftService\";\nimport { ShiftValidationService } from \"@/services/ShiftValidationService\";\nimport { WeekConstraintService } from \"@/services/WeekConstraintService\";\nimport { OptimizeShiftsService } from \"@/services/OptimizeShiftsService\";\nimport {\n  GlobalNotification,\n  ErrorNotification\n} from \"@/utils/GlobalNotification\";\n\nexport class ApplicationContext {\n  private _instances: any;\n\n  private static _context: ApplicationContext;\n\n  private constructor() {\n    this._instances = {};\n  }\n\n  public static getInstance() {\n    if (this._context == null) {\n      this._context = new ApplicationContext();\n    }\n    return this._context;\n  }\n\n  public getActionService(): ActionService {\n    return this.getService(\"ActionService\", () => new ActionService());\n  }\n\n  public getDateService(): DateService {\n    return this.getService(\"DateService\", () => new DateService());\n  }\n\n  public getWorkShiftService(): WorkShiftService {\n    return this.getService(\"WorkShiftService\", () => new WorkShiftService());\n  }\n\n  public getShiftValidationService(): ShiftValidationService {\n    return this.getService(\n      \"ShiftValidationService\",\n      () => new ShiftValidationService()\n    );\n  }\n  public getOptimizeShiftsService(): OptimizeShiftsService {\n    return this.getService(\n      \"OptimizeShiftsService\",\n      () => new OptimizeShiftsService()\n    );\n  }\n\n  public getWeekConstraintService(): WeekConstraintService {\n    return this.getService(\n      \"WeekConstraintService\",\n      () => new WeekConstraintService()\n    );\n  }\n\n  public getErrorNotifications(): GlobalNotification<ErrorNotification> {\n    return this.getService(\n      \"GlobalNotification\",\n      () => new GlobalNotification<ErrorNotification>()\n    );\n  }\n\n  private getService<T>(key: string, initializr: () => T): T {\n    if (!this._instances[key]) {\n      const value = initializr();\n      this._instances[key] = value;\n    }\n    return this._instances[key];\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\nimport WorkShiftInput from \"./WorkShiftInput.vue\";\nimport { WorkContext } from \"@/models/WorkContext\";\nimport { ApplicationContext } from \"@/services/ApplicationContext\";\nimport { factory } from \"@/utils/ConfigLog4j\";\nimport { Action } from \"@/models/Action\";\nimport { stats, cacheable } from \"@/utils/Decorators\";\nimport { CacheConfig, CacheConfigFactory } from \"@/utils/Cache\";\n\nclass TableElement {\n  public static GROUP = \"GROUP\";\n  public static SUBGROUP = \"SUBGROUP\";\n  public static EMPLOYEE = \"EMPLOYEE\";\n\n  public type: string;\n  public id: number;\n\n  public constructor(type: string, id: number) {\n    this.type = type;\n    this.id = id;\n  }\n\n  public isGroup(): boolean {\n    return this.type == TableElement.GROUP;\n  }\n\n  public isSubgroup(): boolean {\n    return this.type == TableElement.SUBGROUP;\n  }\n\n  public isEmployee(): boolean {\n    return this.type == TableElement.EMPLOYEE;\n  }\n}\n\n@Component({ components: { WorkShiftInput } })\nexport default class WorkShiftTable extends Vue {\n  private logger = factory.getLogger(\"components.WorkShiftTable\");\n  @Prop() private context!: WorkContext;\n  @Prop() private inlineValidation!: boolean;\n  private actionService = ApplicationContext.getInstance().getActionService();\n\n  constructor() {\n    super();\n  }\n\n  increment() {\n    this.$store.commit(\"increment\");\n    this.logger.info(() => `Store, increment: ${this.$store.state.count}`);\n  }\n  handleShift(employeeId: number, date: Date, value: string): void {\n    this.logger.info(\n      () => `New shift, employee ${employeeId}, day ${date}, value=${value}`\n    );\n    this.$emit(\"update-shift\", employeeId, date, value);\n  }\n  @stats(\"WorkShiftTable\")\n  getShift(employeeId: number, date: Date): string {\n    return this.context.getShift(\n      employeeId,\n      date,\n      ApplicationContext.getInstance()\n        .getActionService()\n        .getDefaultLabel()\n    );\n  }\n  @stats(\"WorkShiftTable.cached\")\n  @cacheable(\n    \"WorkShiftTable.getEmployeeErrors\",\n    (args: any[]) => args[0] + \"_\" + args[1].toISOString(),\n    new CacheConfigFactory()\n      .ttl(500)\n      .maxSize(2000)\n      .build()\n  )\n  @stats(\"WorkShiftTable.raw\")\n  getEmployeeErrors(employeeId: number, day: Date): Array<string> {\n    if (!this.inlineValidation) {\n      return [];\n    }\n    return ApplicationContext.getInstance()\n      .getShiftValidationService()\n      .getEmployeeErrors(employeeId, day, this.context);\n  }\n  @stats(\"WorkShiftTable\")\n  hasEmployeeErrors(employeeId: number, day: Date): boolean {\n    return this.getEmployeeErrors(employeeId, day).length > 0;\n  }\n  @stats(\"WorkShiftTable.cached\")\n  @cacheable(\n    \"WorkShiftTable.getGroupErrors\",\n    (args: any[]) => args[0] + \"_\" + args[1].toISOString(),\n    new CacheConfigFactory()\n      .ttl(500)\n      .maxSize(2000)\n      .build()\n  )\n  @stats(\"WorkShiftTable.raw\")\n  getGroupErrors(groupId: number, day: Date): Array<string> {\n    if (!this.inlineValidation) {\n      return [];\n    }\n    return ApplicationContext.getInstance()\n      .getShiftValidationService()\n      .getGroupErrors(groupId, day, this.context);\n  }\n  @stats(\"WorkShiftTable\")\n  hasGroupErrors(groupId: number, day: Date): boolean {\n    return this.getGroupErrors(groupId, day).length > 0;\n  }\n  @stats(\"WorkShiftTable.cached\")\n  @cacheable(\n    \"WorkShiftTable.getSubgroupErrors\",\n    (args: any[]) => args[0] + \"_\" + args[1].toISOString(),\n    new CacheConfigFactory()\n      .ttl(500)\n      .maxSize(2000)\n      .build()\n  )\n  @stats(\"WorkShiftTable.raw\")\n  getSubgroupErrors(groupId: number, day: Date): Array<string> {\n    if (!this.inlineValidation) {\n      return [];\n    }\n    return ApplicationContext.getInstance()\n      .getShiftValidationService()\n      .getSubgroupErrors(groupId, day, this.context);\n  }\n  @stats(\"WorkShiftTable\")\n  hasSubgroupErrors(groupId: number, day: Date): boolean {\n    return this.getSubgroupErrors(groupId, day).length > 0;\n  }\n  @stats(\"WorkShiftTable\")\n  getCarsErrors(action: Action, day: Date): Array<string> {\n    if (!this.inlineValidation) {\n      return [];\n    }\n    return ApplicationContext.getInstance()\n      .getShiftValidationService()\n      .getCarsErrors(day, action, this.context);\n  }\n  @stats(\"WorkShiftTable\")\n  hasCarsErrors(action: Action, day: Date): boolean {\n    return this.getCarsErrors(action, day).length > 0;\n  }\n  @stats(\"WorkShiftTable\")\n  employees(): Array<number> {\n    return this.context.sortedEmployees();\n  }\n  @stats(\"WorkShiftTable\")\n  tableElements(): Array<TableElement> {\n    return this.context\n      .sortedEmployees()\n      .map(employeeId => {\n        const elements: TableElement[] = [];\n        const group = this.context.getGroupByEmployee(employeeId);\n        const subgroup = this.context.getSubgroupByEmployee(employeeId);\n        if (this.isStartOfGroup(employeeId) && group) {\n          elements.push(new TableElement(TableElement.GROUP, group.id));\n        }\n        if (this.isStartOfSubgroup(employeeId) && subgroup) {\n          elements.push(new TableElement(TableElement.SUBGROUP, subgroup.id));\n        }\n        elements.push(new TableElement(TableElement.EMPLOYEE, employeeId));\n        return elements;\n      })\n      .flatMap(elements => elements);\n  }\n  @stats(\"WorkShiftTable\")\n  formatHeaderDate(date: Date): string {\n    return ApplicationContext.getInstance()\n      .getDateService()\n      .formatShort(date);\n  }\n  @stats(\"WorkShiftTable\")\n  getDayOfWeekLabel(date: Date): string {\n    const dateService = ApplicationContext.getInstance().getDateService();\n    return dateService.getDayOfWeekLabel(dateService.getDayOfWeek(date));\n  }\n  @stats(\"WorkShiftTable\")\n  days(): number {\n    return ApplicationContext.getInstance()\n      .getDateService()\n      .range(this.rangeStart(), this.rangeEnd()).length;\n  }\n\n  @cacheable(\n    \"WorkShiftTable.day\",\n    (args: any[]) => args[0],\n    CacheConfig.init(40, 1000)\n  )\n  @stats(\"WorkShiftTable\")\n  day(index: number): Date {\n    const d = ApplicationContext.getInstance()\n      .getDateService()\n      .range(this.rangeStart(), this.rangeEnd())[index - 1];\n    return d;\n  }\n  @cacheable(\"WorkShiftTable.rangeStart\", (args: any[]) => \"\")\n  @stats(\"WorkShiftTable\")\n  rangeStart(): Date {\n    return ApplicationContext.getInstance()\n      .getWorkShiftService()\n      .rangeStart(this.context.date);\n  }\n  @cacheable(\"WorkShiftTable.rangeEnd\", (args: any[]) => \"\")\n  @stats(\"WorkShiftTable\")\n  rangeEnd(): Date {\n    return ApplicationContext.getInstance()\n      .getWorkShiftService()\n      .rangeEnd(this.context.date);\n  }\n  @stats(\"WorkShiftTable\")\n  isEndOfWeek(date: Date): boolean {\n    return ApplicationContext.getInstance()\n      .getDateService()\n      .isEndOfWeek(date);\n  }\n\n  @cacheable(\"WorkShiftTable.isStartOfSubgroup\", (args: any[]) => args[0])\n  @stats(\"WorkShiftTable\")\n  isStartOfSubgroup(employeeId: number): boolean {\n    const employees = this.employees();\n    const index = employees.findIndex(id => id == employeeId);\n    if (index == 0) {\n      return true;\n    }\n    const prevEmployeeId = employees[index - 1];\n    const currEmployee = this.context.getEmployee(employeeId);\n    const prevEmployee = this.context.getEmployee(prevEmployeeId);\n    if (currEmployee.subgroupId != prevEmployee.subgroupId) {\n      return true;\n    }\n    return false;\n  }\n  @cacheable(\"WorkShiftTable.isStartOfGroup\", (args: any[]) => args[0])\n  @stats(\"WorkShiftTable\")\n  isStartOfGroup(employeeId: number): boolean {\n    const employees = this.employees();\n    const index = employees.findIndex(id => id == employeeId);\n    if (index == 0) {\n      return true;\n    }\n    const prevEmployeeId = employees[index - 1];\n    const currGroup = this.context.getGroupByEmployee(employeeId);\n    const prevGroup = this.context.getGroupByEmployee(prevEmployeeId);\n    if (currGroup?.id != prevGroup?.id) {\n      return true;\n    }\n    return false;\n  }\n  getSubgroupName(subgroupId: number): string {\n    const subgroup = this.context.getSubgroupById(subgroupId);\n    if (subgroup) {\n      return subgroup.name;\n    }\n    return \"\";\n  }\n  getGroupName(groupId: number): string {\n    const group = this.context.getGroupById(groupId);\n    if (group) {\n      return group.name;\n    }\n    return \"\";\n  }\n  @stats(\"WorkShiftTable\")\n  getUsedCars(date: Date, action: Action): number {\n    const service = ApplicationContext.getInstance().getWorkShiftService();\n    const a = service.countByEmployeesDatesAction(\n      this.employees(),\n      [date],\n      action,\n      this.context\n    );\n    service.countByEmployeesDatesAction(\n      this.employees(),\n      [date],\n      action,\n      this.context\n    );\n    return a;\n  }\n  getTotCars(): number {\n    return this.context.availableCars.total;\n  }\n  morningAction(): Action {\n    return Action.MORNING;\n  }\n  afternoonAction(): Action {\n    return Action.AFTERNOON;\n  }\n  availableStates(): Array<string> {\n    return ApplicationContext.getInstance()\n      .getActionService()\n      .getAllLabels();\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftTable.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftTable.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./WorkShiftTable.vue?vue&type=template&id=2227b553&scoped=true&\"\nimport script from \"./WorkShiftTable.vue?vue&type=script&lang=ts&\"\nexport * from \"./WorkShiftTable.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./WorkShiftTable.vue?vue&type=style&index=0&id=2227b553&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2227b553\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VContainer,VRow,VSimpleTable,VTooltip})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-col',{attrs:{\"md\":\"8\"}},[_c('v-row',{attrs:{\"justify\":\"end\"}},[_c('v-switch',{attrs:{\"label\":\"Validazione attiva\"},on:{\"change\":_vm.handleValidation},model:{value:(_vm.validate),callback:function ($$v) {_vm.validate=$$v},expression:\"validate\"}}),_c('v-btn',{staticClass:\"ma-2\",attrs:{\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.handleExportJson}},[_vm._v(\" Save \"),_c('v-icon',{attrs:{\"dark\":\"\",\"right\":\"\"}},[_vm._v(\"mdi-content-save\")])],1),_c('v-menu',{attrs:{\"close-on-content-click\":false,\"nudge-right\":40,\"transition\":\"scale-transition\",\"offset-y\":\"\",\"min-width\":\"290px\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nreturn [_c('v-btn',_vm._g({staticClass:\"ma-2\",attrs:{\"color\":\"primary\",\"dark\":\"\"}},on),[_vm._v(\" Open \"),_c('v-icon',{attrs:{\"dark\":\"\",\"right\":\"\"}},[_vm._v(\"mdi-file\")])],1)]}}])},[_c('v-file-input',{attrs:{\"label\":\"Import\"},on:{\"change\":_vm.handleImportJson}})],1),_c('v-btn',{staticClass:\"ma-2\",attrs:{\"color\":\"purple\",\"dark\":\"\"},on:{\"click\":_vm.handleExportExcel}},[_vm._v(\" Print \"),_c('v-icon',{attrs:{\"dark\":\"\",\"right\":\"\"}},[_vm._v(\"mdi-file-excel\")])],1),_c('v-dialog',{attrs:{\"persistent\":\"\",\"max-width\":\"600px\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"ma-2\",attrs:{\"color\":\"red\",\"dark\":\"\"}},'v-btn',attrs,false),on),[_vm._v(\" Delete \"),_c('v-icon',{attrs:{\"dark\":\"\",\"right\":\"\"}},[_vm._v(\"mdi-delete\")])],1)]}}]),model:{value:(_vm.deleteDialog),callback:function ($$v) {_vm.deleteDialog=$$v},expression:\"deleteDialog\"}},[_c('v-card',[_c('v-card-title',[_c('span',{staticClass:\"headline\"},[_vm._v(\"Confirm deletion?\")])]),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"blue darken-1\",\"text\":\"\"},on:{\"click\":function($event){_vm.deleteDialog = false}}},[_vm._v(\"Cancel\")]),_c('v-btn',{attrs:{\"color\":\"blue darken-1\",\"text\":\"\"},on:{\"click\":function($event){_vm.deleteDialog = false;\n              _vm.handleClearData();}}},[_vm._v(\"Confirm\")])],1)],1)],1),_c('v-btn',{staticClass:\"ma-2\",attrs:{\"color\":\"purple\",\"dark\":\"\"},on:{\"click\":_vm.handleOptimize}},[_vm._v(\" Optimize \"),_c('v-icon',{attrs:{\"dark\":\"\",\"right\":\"\"}},[_vm._v(\"mdi-nuke\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { factory } from \"@/utils/ConfigLog4j\";\n\n@Component({})\nexport default class WorkShiftActions extends Vue {\n  private logger = factory.getLogger(\"WorkShiftActions\");\n  private validate = true;\n  private deleteDialog = false;\n\n  handleValidation() {\n    this.logger.info(() => `validation: ${this.validate}`);\n    this.$emit(\"update-validation\", this.validate);\n  }\n  handleExportJson() {\n    this.$emit(\"export-json\");\n  }\n  handleImportJson(file: File) {\n    this.$emit(\"import-json\", file);\n  }\n  handleExportExcel() {\n    this.$emit(\"export-excel\");\n  }\n  handleClearData() {\n    this.$emit(\"clear-data\");\n  }\n  handleOptimize() {\n    this.$emit(\"optimize\");\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftActions.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WorkShiftActions.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./WorkShiftActions.vue?vue&type=template&id=cd1aaffe&\"\nimport script from \"./WorkShiftActions.vue?vue&type=script&lang=ts&\"\nexport * from \"./WorkShiftActions.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VFileInput } from 'vuetify/lib/components/VFileInput';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardTitle,VCol,VDialog,VFileInput,VIcon,VMenu,VRow,VSpacer,VSwitch})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-dialog',{attrs:{\"max-width\":\"290\",\"persistent\":\"\"},model:{value:(_vm.hasErrors),callback:function ($$v) {_vm.hasErrors=$$v},expression:\"hasErrors\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"headline\"},[_vm._v(_vm._s(_vm.title))]),_c('v-card-text',[_vm._v(\" \"+_vm._s(_vm.message)+\" \")]),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"green darken-1\",\"text\":\"\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.acceptMessage()}}},[_vm._v(\"Close\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { factory } from \"@/utils/ConfigLog4j\";\r\nimport { ApplicationContext } from \"@/services/ApplicationContext\";\r\nimport {\r\n  GlobalNotification,\r\n  ErrorNotification\r\n} from \"@/utils/GlobalNotification\";\r\n\r\nimport Vue from \"vue\";\r\n\r\nconst logger = factory.getLogger(\"components.ErrorDialog\");\r\n\r\nexport default Vue.extend({\r\n  name: \"error-dialog\",\r\n  data() {\r\n    return {\r\n      notifications: ApplicationContext.getInstance().getErrorNotifications()\r\n    };\r\n  },\r\n  computed: {\r\n    hasErrors: {\r\n      set(value: boolean) {\r\n        logger.debug(() => `Set hasErrors: ${value}`);\r\n      },\r\n      get(): boolean {\r\n        const hasErrors = this.notifications.has();\r\n        logger.debug(() => `hasErrors: ${hasErrors}`);\r\n        return this.notifications.has();\r\n      }\r\n    },\r\n    title(): string {\r\n      if (this.notifications.has()) {\r\n        const title = this.notifications.get().title;\r\n        return title;\r\n      }\r\n      return \"\";\r\n    },\r\n    message(): string {\r\n      if (this.notifications.has()) {\r\n        const notification = this.notifications.get();\r\n        let message = notification.message;\r\n        if (notification.wsError && notification.wsError.message) {\r\n          message += \" - \" + notification.wsError.message;\r\n        }\r\n        return message;\r\n      }\r\n      return \"\";\r\n    }\r\n  },\r\n  methods: {\r\n    acceptMessage(): void {\r\n      logger.info(() => `Message accepted.`);\r\n      this.notifications.pop();\r\n    }\r\n  },\r\n  watch: {\r\n    notifications: {\r\n      handler: (notification: GlobalNotification<ErrorNotification>) => {\r\n        logger.info(() => `Remaining notifications ${notification.count()}`);\r\n      },\r\n      deep: true\r\n    }\r\n  }\r\n});\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ErrorDialog.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ErrorDialog.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ErrorDialog.vue?vue&type=template&id=748165b4&scoped=true&\"\nimport script from \"./ErrorDialog.vue?vue&type=script&lang=ts&\"\nexport * from \"./ErrorDialog.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"748165b4\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardText,VCardTitle,VDialog,VSpacer})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-overlay',{attrs:{\"value\":_vm.dialog}},[_c('v-dialog',{attrs:{\"hide-overlay\":\"\",\"persistent\":\"\",\"width\":\"300\"},model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('v-card',{attrs:{\"color\":\"primary\",\"dark\":\"\"}},[_c('v-card-text',[_vm._v(\"Processing \"),_c('v-progress-linear',{staticClass:\"mb-0\",attrs:{\"indeterminate\":\"\",\"color\":\"white\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { factory } from \"@/utils/ConfigLog4j\";\r\n\r\nimport Vue from \"vue\";\r\nimport EventBus from \"../utils/EventBus\";\r\n\r\nconst logger = factory.getLogger(\"components.LoaderDialog\");\r\n\r\nexport default Vue.extend({\r\n  name: \"error-dialog\",\r\n  data() {\r\n    return {\r\n      pending: 0\r\n    };\r\n  },\r\n  computed: {\r\n    dialog(): boolean {\r\n      return this.pending > 0;\r\n    }\r\n  },\r\n  mounted() {\r\n    EventBus.$on(\"ASYNC_ACTION_START\", (payload: any) => {\r\n      this.pending++;\r\n      logger.info(`async action started, pending ${this.pending}: ${payload}`);\r\n    });\r\n    EventBus.$on(\"ASYNC_ACTION_END\", (payload: any) => {\r\n      this.pending--;\r\n      logger.info(`async action ended, pending ${this.pending}: ${payload}`);\r\n    });\r\n  }\r\n});\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LoaderDialog.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LoaderDialog.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./LoaderDialog.vue?vue&type=template&id=7f2473eb&scoped=true&\"\nimport script from \"./LoaderDialog.vue?vue&type=script&lang=ts&\"\nexport * from \"./LoaderDialog.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7f2473eb\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VOverlay } from 'vuetify/lib/components/VOverlay';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\ninstallComponents(component, {VCard,VCardText,VDialog,VOverlay,VProgressLinear})\n","export class AvailableCars {\r\n  private _total = 0;\r\n\r\n  public set total(total: number) {\r\n    this._total = total;\r\n  }\r\n\r\n  public get total() {\r\n    return this._total;\r\n  }\r\n}\r\n","export class Shift {\r\n  private _employeeId = 0;\r\n  private _date = new Date();\r\n  private _value = \"\";\r\n\r\n  public constructor(employeeId: number, date: Date, value: string) {\r\n    this.employeeId = employeeId;\r\n    this.date = date;\r\n    this.value = value;\r\n  }\r\n\r\n  public clone(): Shift {\r\n    return new Shift(this.employeeId, this.date, this.value);\r\n  }\r\n\r\n  public get employeeId() {\r\n    return this._employeeId;\r\n  }\r\n  public set employeeId(employeeId: number) {\r\n    this._employeeId = employeeId;\r\n  }\r\n  public get date() {\r\n    return this._date;\r\n  }\r\n  public set date(date: Date) {\r\n    this._date = date;\r\n  }\r\n  public get value() {\r\n    return this._value;\r\n  }\r\n  public set value(value: string) {\r\n    this._value = value;\r\n  }\r\n}\r\n","export class ArrayUtil {\r\n  public static delete<E>(list: E[], match: (e: E) => boolean): void {\r\n    for (let i = 0; i < list.length; i++) {\r\n      if (match(list[i])) {\r\n        list.splice(i, 1);\r\n        i--;\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Employee } from \"./Employee\";\r\nimport { AvailableCars } from \"./AvailableCars\";\r\nimport { Subgroup } from \"./Subgroup\";\r\nimport { Group } from \"./Group\";\r\nimport { Shift } from \"./Shift\";\r\nimport { ArrayUtil } from \"@/utils/ArrayUtil\";\r\nimport { ApplicationContext } from \"@/services/ApplicationContext\";\r\n\r\nexport class WorkContext {\r\n  private _date: Date;\r\n  private _employees: Map<number, Employee>;\r\n  private _groups: Map<number, Group>;\r\n  private _subgroups: Map<number, Subgroup>;\r\n  private _availableCars: AvailableCars;\r\n\r\n  private _workShifts: Array<Shift>;\r\n  private _workShiftsMap: Map<number, Map<string, string>>;\r\n\r\n  public constructor() {\r\n    this._date = new Date();\r\n    this._employees = new Map();\r\n    this._groups = new Map();\r\n    this._subgroups = new Map();\r\n    this._availableCars = new AvailableCars();\r\n    this._workShifts = new Array<Shift>();\r\n    this._workShiftsMap = new Map<number, Map<string, string>>();\r\n  }\r\n\r\n  public getEmployee(id: number): Employee {\r\n    if (this.employees.has(id)) {\r\n      return this.employees.get(id) as Employee;\r\n    }\r\n    throw new Error(\"Employee \" + id + \" unknown.\");\r\n  }\r\n  public sortedEmployees(): Array<number> {\r\n    const employees = Array.from(this.employees.values());\r\n\r\n    employees.sort((employee1, employee2) => {\r\n      const idSubgroup1 = employee1.subgroupId;\r\n      const idSubgroup2 = employee2.subgroupId;\r\n\r\n      if (!idSubgroup1) {\r\n        return -1;\r\n      }\r\n      if (!idSubgroup2) {\r\n        return 1;\r\n      }\r\n      if (idSubgroup1 != idSubgroup2) {\r\n        return idSubgroup1 - idSubgroup2;\r\n      }\r\n      const subgroup1 = this.subgroups.get(idSubgroup1);\r\n      const subgroup2 = this.subgroups.get(idSubgroup2);\r\n      let idGroup1 = 0;\r\n      if (subgroup1) {\r\n        idGroup1 = subgroup1.parent;\r\n      }\r\n      let idGroup2 = 0;\r\n      if (subgroup2) {\r\n        idGroup2 = subgroup2.parent;\r\n      }\r\n      if (idGroup1 != idGroup2) {\r\n        return idGroup1 - idGroup2;\r\n      }\r\n      return employee1.id - employee2.id;\r\n    });\r\n    return employees.map(e => e.id);\r\n  }\r\n  public sortedGroups(): Array<number> {\r\n    return Array.from(this.groups.values())\r\n      .sort((group1, group2) => {\r\n        return group1.id - group2.id;\r\n      })\r\n      .map(group => group.id);\r\n  }\r\n  public sortedSubgroups(): Array<number> {\r\n    return Array.from(this.subgroups.values())\r\n      .sort((subgroup1, subgroup2) => {\r\n        return subgroup1.id - subgroup2.id;\r\n      })\r\n      .map(subgroup => subgroup.id);\r\n  }\r\n  public getSubgroupByEmployee(employeeId: number): Subgroup | undefined {\r\n    const subgroupId = this.getEmployee(employeeId).subgroupId;\r\n    if (subgroupId) {\r\n      return this.getSubgroupById(subgroupId);\r\n    }\r\n    return undefined;\r\n  }\r\n  public getSubgroupById(subgroupId: number): Subgroup | undefined {\r\n    return this.subgroups.get(subgroupId);\r\n  }\r\n  public getGroupByEmployee(employeeId: number): Group | undefined {\r\n    const subgroup = this.getSubgroupByEmployee(employeeId);\r\n    if (subgroup && subgroup.parent) {\r\n      return this.groups.get(subgroup.parent);\r\n    }\r\n    return undefined;\r\n  }\r\n  public getGroupById(groupId: number): Group | undefined {\r\n    return this.groups.get(groupId);\r\n  }\r\n\r\n  public setShift(employeeId: number, date: Date, value: string): void {\r\n    const dateService = ApplicationContext.getInstance().getDateService();\r\n    ArrayUtil.delete(\r\n      this.workShifts,\r\n      s =>\r\n        s.employeeId == employeeId &&\r\n        dateService.format(s.date) == dateService.format(date)\r\n    );\r\n    this.workShifts.push(new Shift(employeeId, date, value));\r\n    this.setShiftMap(employeeId, date, value);\r\n  }\r\n\r\n  protected setShiftMap(employeeId: number, date: Date, value: string) {\r\n    const dateService = ApplicationContext.getInstance().getDateService();\r\n    const map = this._workShiftsMap;\r\n    if (!map.has(employeeId)) {\r\n      map.set(employeeId, new Map<string, string>());\r\n    }\r\n    map.get(employeeId)?.set(dateService.format(date), value);\r\n  }\r\n\r\n  public getShift(\r\n    employeeId: number,\r\n    date: Date,\r\n    defaultValue = ApplicationContext.getInstance()\r\n      .getActionService()\r\n      .getDefaultLabel()\r\n  ): string {\r\n    // make vue aware of the update\r\n    this.workShifts.length;\r\n\r\n    const dateService = ApplicationContext.getInstance().getDateService();\r\n    const value = this._workShiftsMap\r\n      .get(employeeId)\r\n      ?.get(dateService.format(date));\r\n    if (value) {\r\n      return value;\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n  public deleteShifts(): void {\r\n    const from = ApplicationContext.getInstance()\r\n      .getWorkShiftService()\r\n      .rangeStart(this.date);\r\n    const to = ApplicationContext.getInstance()\r\n      .getWorkShiftService()\r\n      .rangeEnd(this.date);\r\n\r\n    this.workShifts = this.workShifts.filter(s => s.date < from || s.date > to);\r\n    this._workShiftsMap = new Map<number, Map<string, string>>();\r\n    this.workShifts.forEach(shift =>\r\n      this.setShiftMap(shift.employeeId, shift.date, shift.value)\r\n    );\r\n  }\r\n  public set date(date: Date) {\r\n    this._date = date;\r\n  }\r\n  public get date() {\r\n    return this._date;\r\n  }\r\n\r\n  public set employees(employees: Map<number, Employee>) {\r\n    this._employees = employees;\r\n  }\r\n  public get employees() {\r\n    return this._employees;\r\n  }\r\n  public set availableCars(availableCars: AvailableCars) {\r\n    this._availableCars = availableCars;\r\n  }\r\n  public get availableCars() {\r\n    return this._availableCars;\r\n  }\r\n  public set workShifts(workShifts: Array<Shift>) {\r\n    this._workShifts = workShifts;\r\n  }\r\n  public get workShifts() {\r\n    return this._workShifts;\r\n  }\r\n  public set groups(groups: Map<number, Group>) {\r\n    this._groups = groups;\r\n  }\r\n  public get groups() {\r\n    return this._groups;\r\n  }\r\n  public set subgroups(subgroups: Map<number, Subgroup>) {\r\n    this._subgroups = subgroups;\r\n  }\r\n  public get subgroups() {\r\n    return this._subgroups;\r\n  }\r\n}\r\n","export class Employee {\r\n  private _id = 0;\r\n  private _name = \"\";\r\n  private _subgroupId: number | null = null;\r\n\r\n  public totWeekShifts = 0;\r\n  public maxWeekMornings = 0;\r\n  public maxWeekAfternoons = 0;\r\n\r\n  public clone(): Employee {\r\n    const clone = new Employee();\r\n    clone.id = this.id;\r\n    clone.name = this.name;\r\n    clone.subgroupId = this.subgroupId;\r\n    clone.totWeekShifts = this.totWeekShifts;\r\n    clone.maxWeekMornings = this.maxWeekMornings;\r\n    clone.maxWeekAfternoons = this.maxWeekAfternoons;\r\n    return clone;\r\n  }\r\n\r\n  public set name(name: string) {\r\n    this._name = name;\r\n  }\r\n\r\n  public get name() {\r\n    return this._name;\r\n  }\r\n  public set id(id: number) {\r\n    this._id = id;\r\n  }\r\n\r\n  public get id() {\r\n    return this._id;\r\n  }\r\n  public set subgroupId(subgroupId: number | null) {\r\n    this._subgroupId = subgroupId;\r\n  }\r\n\r\n  public get subgroupId() {\r\n    return this._subgroupId;\r\n  }\r\n}\r\n","import { WeekConstraint } from \"@/models/WeekConstraint\";\r\n\r\nexport class Group {\r\n  private _id = 0;\r\n  private _name = \"\";\r\n  private _constraints = new Array<WeekConstraint>();\r\n\r\n  public clone(): Group {\r\n    return this.doClone(new Group());\r\n  }\r\n\r\n  protected doClone(clone: Group) {\r\n    clone.id = this.id;\r\n    clone.name = this.name;\r\n    clone.constraints = this.constraints.map(c => c.clone());\r\n    return clone;\r\n  }\r\n\r\n  public set name(name: string) {\r\n    this._name = name;\r\n  }\r\n\r\n  public get name() {\r\n    return this._name;\r\n  }\r\n  public set id(id: number) {\r\n    this._id = id;\r\n  }\r\n\r\n  public get id() {\r\n    return this._id;\r\n  }\r\n\r\n  public set constraints(constraints: Array<WeekConstraint>) {\r\n    this._constraints = constraints;\r\n  }\r\n  public get constraints() {\r\n    return this._constraints;\r\n  }\r\n\r\n  public toString(): string {\r\n    return `id ${this.id} name ${this.name} constraints ${this.constraints}`;\r\n  }\r\n}\r\n","import { Group } from \"./Group\";\r\n\r\nexport class Subgroup extends Group {\r\n  private _parent?: number;\r\n\r\n  public constructor() {\r\n    super();\r\n  }\r\n\r\n  public clone(): Subgroup {\r\n    const clone = super.doClone(new Subgroup()) as Subgroup;\r\n    clone.parent = this.parent;\r\n    return clone;\r\n  }\r\n\r\n  public set parent(parent: number) {\r\n    this._parent = parent;\r\n  }\r\n\r\n  public get parent(): number {\r\n    if (this._parent === undefined) {\r\n      throw Error(`Missing parent for ${this}`);\r\n    } else {\r\n      return this._parent;\r\n    }\r\n  }\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-col',{attrs:{\"md\":\"2\"}},[_c('v-menu',{attrs:{\"close-on-content-click\":false,\"nudge-right\":40,\"transition\":\"scale-transition\",\"offset-y\":\"\",\"min-width\":\"290px\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nreturn [_c('v-text-field',_vm._g({attrs:{\"label\":\"Mese di riferimento\",\"readonly\":\"\",\"width\":\"30\"},model:{value:(_vm.currentValue),callback:function ($$v) {_vm.currentValue=$$v},expression:\"currentValue\"}},on))]}}]),model:{value:(_vm.menu),callback:function ($$v) {_vm.menu=$$v},expression:\"menu\"}},[_c('v-date-picker',{attrs:{\"type\":\"month\"},on:{\"input\":function($event){_vm.menu = false},\"change\":_vm.update},model:{value:(_vm.currentValue),callback:function ($$v) {_vm.currentValue=$$v},expression:\"currentValue\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { factory } from \"../utils/ConfigLog4j\";\r\n\r\n@Component\r\nexport default class MonthPicker extends Vue {\r\n  private logger = factory.getLogger(\"components.MonthPicker\");\r\n\r\n  @Prop() private value!: Date;\r\n\r\n  private currentValue = \"\";\r\n  private menu = false;\r\n\r\n  private get model() {\r\n    if (this.currentValue == \"\") {\r\n      this.currentValue = this.value.toUTCString().substring(0, 10);\r\n    }\r\n    return this.currentValue;\r\n  }\r\n  private set model(value: string) {\r\n    this.currentValue = value;\r\n  }\r\n\r\n  update() {\r\n    this.logger.info(() => `Updated month: ${this.currentValue}`);\r\n    this.$emit(\"update-date\", this.currentValue + \"-01\");\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MonthPicker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MonthPicker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MonthPicker.vue?vue&type=template&id=970d364a&scoped=true&\"\nimport script from \"./MonthPicker.vue?vue&type=script&lang=ts&\"\nexport * from \"./MonthPicker.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"970d364a\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDatePicker } from 'vuetify/lib/components/VDatePicker';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCol,VDatePicker,VMenu,VTextField})\n","import { WorkContext } from \"@/models/WorkContext\";\r\nimport { Employee } from \"@/models/Employee\";\r\nimport { Group } from \"@/models/Group\";\r\nimport { WeekConstraint } from \"@/models/WeekConstraint\";\r\nimport { Subgroup } from \"@/models/Subgroup\";\r\nimport { ApplicationContext } from \"@/services/ApplicationContext\";\r\nimport { Shift } from \"@/models/Shift\";\r\n\r\nexport class ContextDeserializer {\r\n  private dateService = ApplicationContext.getInstance().getDateService();\r\n  private actionService = ApplicationContext.getInstance().getActionService();\r\n\r\n  public deserializeContext(obj: object): WorkContext {\r\n    const context = new WorkContext();\r\n    context.date = this.dateValue(obj, \"date\");\r\n    this.values(obj, \"employees\")\r\n      .map(o => this.deserializeEmployee(o))\r\n      .forEach(o => context.employees.set(o.id, o));\r\n    this.values(obj, \"groups\")\r\n      .map(o => this.deserializeGroup(o))\r\n      .forEach(o => context.groups.set(o.id, o));\r\n    this.values(obj, \"subgroups\")\r\n      .map(o => this.deserializeSubgroup(o))\r\n      .forEach(o => context.subgroups.set(o.id, o));\r\n    this.values(obj, \"shifts\")\r\n      .map(o => this.deserializeShift(o))\r\n      .forEach(shift => {\r\n        context.setShift(shift.employeeId, shift.date, shift.value);\r\n      });\r\n    context.availableCars.total = this.numberValue(obj, \"availableCars\");\r\n    return context;\r\n  }\r\n  protected deserializeEmployee(obj: any): Employee {\r\n    const e = new Employee();\r\n    e.id = this.numberValue(obj, \"id\");\r\n    e.name = this.stringValue(obj, \"name\");\r\n    e.subgroupId = this.numberValue(obj, \"subgroupId\");\r\n    e.totWeekShifts = this.numberValue(obj, \"totWeekShifts\");\r\n    e.maxWeekMornings = this.numberValue(obj, \"maxWeekMornings\");\r\n    e.maxWeekAfternoons = this.numberValue(obj, \"maxWeekAfternoons\");\r\n    return e;\r\n  }\r\n  protected deserializeGroup(obj: any): Group {\r\n    const g = new Group();\r\n    g.id = this.numberValue(obj, \"id\");\r\n    g.name = this.stringValue(obj, \"name\");\r\n    this.values(obj, \"constraints\")\r\n      .map(constraint => this.deserializeWeekConstraint(constraint))\r\n      .forEach(constraint => g.constraints.push(constraint));\r\n    return g;\r\n  }\r\n  protected deserializeSubgroup(obj: any): Subgroup {\r\n    const g = new Subgroup();\r\n    g.id = this.numberValue(obj, \"id\");\r\n    g.name = this.stringValue(obj, \"name\");\r\n    g.parent = this.numberValue(obj, \"groupId\");\r\n    this.values(obj, \"constraints\")\r\n      .map(constraint => this.deserializeWeekConstraint(constraint))\r\n      .forEach(constraint => g.constraints.push(constraint));\r\n    return g;\r\n  }\r\n  protected deserializeWeekConstraint(obj: object): WeekConstraint {\r\n    const dayOfWeek = this.dateService.getDayOfWeekFromName(\r\n      this.stringValue(obj, \"dayOfWeek\")\r\n    );\r\n    const action = this.actionService.getActionFromName(\r\n      this.stringValue(obj, \"action\")\r\n    );\r\n    const value = this.numberValue(obj, \"value\");\r\n    return WeekConstraint.min(dayOfWeek, action, value);\r\n  }\r\n  protected deserializeShift(obj: object): Shift {\r\n    const employeeId = this.numberValue(obj, \"employeeId\");\r\n    const date = this.dateValue(obj, \"date\");\r\n    const value = this.stringValue(obj, \"value\");\r\n    return new Shift(employeeId, date, value);\r\n  }\r\n  private dateValue(obj: any, key: string): Date {\r\n    const value = this.stringValue(obj, key);\r\n    return this.dateService.parse(value);\r\n  }\r\n  private numberValue(obj: any, key: string): number {\r\n    const value = this.value(obj, key);\r\n    return value as number;\r\n  }\r\n  private stringValue(obj: any, key: string): string {\r\n    const value = this.value(obj, key);\r\n    return value as string;\r\n  }\r\n  private values(obj: any, key: string): Array<object> {\r\n    return this.value(obj, key) as Array<object>;\r\n  }\r\n  private value(obj: any, key: string): unknown {\r\n    const keys = Object.keys(obj);\r\n    let targetIndex = -1;\r\n    for (let i = 0; i < keys.length; i++) {\r\n      if (keys[i] == key) {\r\n        targetIndex = i;\r\n      }\r\n    }\r\n    return Object.values(obj)[targetIndex];\r\n  }\r\n}\r\n","import { WorkContext } from \"@/models/WorkContext\";\r\nimport { ApplicationContext } from \"@/services/ApplicationContext\";\r\nimport { Shift } from \"@/models/Shift\";\r\nimport { Employee } from \"@/models/Employee\";\r\nimport { Group } from \"@/models/Group\";\r\nimport { Subgroup } from \"@/models/Subgroup\";\r\nimport { WeekConstraint } from \"@/models/WeekConstraint\";\r\n\r\nexport class ContextSerializer {\r\n  private dateService = ApplicationContext.getInstance().getDateService();\r\n  private actionService = ApplicationContext.getInstance().getActionService();\r\n\r\n  public serializeContext(context: WorkContext, from: Date, to: Date): object {\r\n    const outCtx = {\r\n      date: this.dateService.format(context.date),\r\n      employees: Array.from(context.employees.values()).map(e =>\r\n        this.serializeEmployee(e)\r\n      ),\r\n      groups: Array.from(context.groups.values()).map(g =>\r\n        this.serializeGroup(g)\r\n      ),\r\n      subgroups: Array.from(context.subgroups.values()).map(g =>\r\n        this.serializeSubgroup(g)\r\n      ),\r\n      availableCars: context.availableCars.total,\r\n      shifts: Array.from(context.workShifts.values()).map(s =>\r\n        this.serializeShift(s)\r\n      )\r\n    };\r\n    return outCtx;\r\n  }\r\n\r\n  protected serializeEmployee(employee: Employee) {\r\n    return {\r\n      id: employee.id,\r\n      name: employee.name,\r\n      subgroupId: employee.subgroupId,\r\n      totWeekShifts: employee.totWeekShifts,\r\n      maxWeekMornings: employee.maxWeekMornings,\r\n      maxWeekAfternoons: employee.maxWeekAfternoons\r\n    };\r\n  }\r\n  protected serializeGroup(group: Group) {\r\n    return {\r\n      id: group.id,\r\n      name: group.name,\r\n      constraints: group.constraints.map(c => this.serializeWeekConstraint(c))\r\n    };\r\n  }\r\n  protected serializeSubgroup(subgroup: Subgroup) {\r\n    return {\r\n      id: subgroup.id,\r\n      name: subgroup.name,\r\n      groupId: subgroup.parent,\r\n      constraints: subgroup.constraints.map(c =>\r\n        this.serializeWeekConstraint(c)\r\n      )\r\n    };\r\n  }\r\n  protected serializeWeekConstraint(constraint: WeekConstraint) {\r\n    return {\r\n      dayOfWeek: this.dateService.getDayOfWeekName(constraint.dayOfWeek),\r\n      type: constraint.type,\r\n      action: this.actionService.getActionName(constraint.action),\r\n      value: constraint.value\r\n    };\r\n  }\r\n  protected serializeShift(shift: Shift) {\r\n    return {\r\n      employeeId: shift.employeeId,\r\n      date: this.dateService.format(shift.date),\r\n      value: shift.value\r\n    };\r\n  }\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport WorkShiftTable from \"@/components/WorkShiftTable.vue\";\nimport WorkShiftActions from \"@/components/WorkShiftActions.vue\";\nimport ErrorDialog from \"@/components/ErrorDialog.vue\";\nimport LoaderDialog from \"@/components/LoaderDialog.vue\";\nimport { WorkContext } from \"@/models/WorkContext\";\nimport { ApplicationContext } from \"@/services/ApplicationContext\";\nimport { Employee } from \"@/models/Employee\";\nimport { Group } from \"@/models/Group\";\nimport { Subgroup } from \"@/models/Subgroup\";\nimport { Action } from \"@/models/Action\";\nimport { WeekConstraint } from \"@/models/WeekConstraint\";\nimport { factory } from \"@/utils/ConfigLog4j\";\nimport MonthPicker from \"@/components/MonthPicker.vue\";\nimport { ContextDeserializer } from \"./transformer/ContextDeserializer\";\nimport { ContextSerializer } from \"./transformer/ContextSerializer\";\nimport { saveAs } from \"file-saver\";\nimport { BackendWebService } from \"./utils/WebService\";\nimport { ErrorNotification } from \"./utils/GlobalNotification\";\n\n@Component({\n  components: {\n    WorkShiftTable,\n    MonthPicker,\n    WorkShiftActions,\n    ErrorDialog,\n    LoaderDialog\n  }\n})\nexport default class App extends Vue {\n  private logger = factory.getLogger(\"App\");\n  private context: WorkContext;\n  private inlineValidation = true;\n\n  constructor() {\n    super();\n    const dateService = ApplicationContext.getInstance().getDateService();\n    const context = new WorkContext();\n    this.context = context;\n    context.date = dateService.parse(dateService.format(new Date()));\n\n    App.group(context, 1, \"Macro1\", App.weekConstraint(0, 1, 1, 1));\n    App.group(context, 2, \"Macro2\", App.weekConstraint(0, 1, 1, 1));\n    App.group(context, 3, \"Macro3\", App.weekConstraint(0, 0, 0, 0));\n    App.subgroup(context, 1, \"Mogliano\", 1, App.weekConstraint(1, 0, 0, 0));\n    App.subgroup(context, 2, \"Preganziol\", 1, App.weekConstraint(1, 0, 0, 0));\n    App.subgroup(\n      context,\n      3,\n      \"Casale / Roncade\",\n      1,\n      App.weekConstraint(1, 0, 0, 0)\n    );\n    App.subgroup(context, 4, \"S.Bona\", 2, App.weekConstraint(1, 0, 0, 0));\n    App.subgroup(context, 5, \"c.citt\", 2, App.weekConstraint(1, 0, 0, 0));\n    App.subgroup(context, 6, \"S.Zeno\", 2, App.weekConstraint(1, 0, 0, 0));\n    App.subgroup(\n      context,\n      7,\n      \"S.Biagio Silea\",\n      2,\n      App.weekConstraint(1, 0, 0, 0)\n    );\n    App.subgroup(context, 8, \"CP\", 3, App.weekConstraint(1, 0, 0, 0));\n\n    App.employee(context, 1, \"ALBORE P. SANDRO\", 1, 5, 5, 2);\n    App.employee(context, 2, \"CHINELLATO MONIA\", 1, 5, 5, 2);\n    App.employee(context, 3, \"GIACOMIN BARBARA\", 1, 5, 5, 0);\n\n    App.employee(context, 4, \"RIGO FRANCESCA\", 2, 5, 5, 2);\n    App.employee(context, 5, \"BARBATO GIUSEPPE\", 2, 5, 5, 2);\n    App.employee(context, 6, \"VIALE MARTA\", 2, 5, 5, 2);\n\n    App.employee(context, 7, \"COSTANTINI RENZO\", 3, 5, 5, 2);\n    App.employee(context, 8, \"BERTON ELISABETTA\", 3, 4, 4, 2);\n    App.employee(context, 9, \"TOZZATO MARTINA\", 3, 5, 5, 2);\n\n    App.employee(context, 10, \"BERALDO SILVIA\", 4, 5, 5, 2);\n    App.employee(context, 11, \"CITTON MARZIA\", 4, 5, 5, 2);\n    App.employee(context, 12, \"CERON CESARE\", 4, 5, 5, 2);\n\n    App.employee(context, 13, \"VANIN STEFANIA\", 5, 5, 5, 2);\n    App.employee(context, 14, \"SERAFIN SERENA\", 5, 5, 5, 2);\n    App.employee(context, 15, \"MAREN FABIO\", 5, 5, 5, 2);\n\n    App.employee(context, 16, \"TONON CHRISTIAN\", 6, 5, 5, 2);\n    App.employee(context, 17, \"CARPIN ANNALISA\", 6, 5, 5, 2);\n\n    App.employee(context, 18, \"SPIGARIOL PAOLO\", 7, 5, 5, 2);\n    App.employee(context, 19, \"VIANELLO MARTA\", 7, 5, 5, 2);\n    App.employee(context, 20, \"BOT CLAUDIA\", 7, 4, 4, 2);\n\n    App.employee(context, 21, \"BEZZI SILVIA\", 8, 5, 5, 2);\n    App.employee(context, 22, \"BRUNELLO VANIA\", 8, 5, 5, 2);\n\n    context.availableCars.total = 10;\n  }\n\n  handleExportExcel() {\n    this.logger.info(() => `Excel export`);\n\n    new BackendWebService()\n      .url(\"/workshifts-rest/export\")\n      .responseType(\"blob\")\n      .post()\n      .headerJson()\n      .call(\n        new ContextSerializer().serializeContext(\n          this.context,\n          this.rangeStart(),\n          this.rangeEnd()\n        )\n      )\n      .then(response => {\n        const blob = new Blob([response.data]);\n        const formattedDate = ApplicationContext.getInstance()\n          .getDateService()\n          .formatYYYYMM(this.context.date);\n        const filename = `Turni lavorativi ${formattedDate}.xlsx`;\n        this.logger.info(() => `Save file as ${filename}`);\n        saveAs(blob, filename);\n      })\n      .catch(error => {\n        ApplicationContext.getInstance()\n          .getErrorNotifications()\n          .add(new ErrorNotification(\"Error\", \"Error exporting calendar\"));\n      });\n  }\n  handleValidation(validate: boolean) {\n    this.logger.info(() => `Validation ${validate}`);\n    this.inlineValidation = validate;\n  }\n  handleExportJson() {\n    this.logger.info(() => `Json export`);\n    const obj = new ContextSerializer().serializeContext(\n      this.context,\n      this.rangeStart(),\n      this.rangeEnd()\n    );\n    const content = JSON.stringify(obj);\n    const blob = new Blob([content], { type: \"application/json\" });\n    saveAs(blob, \"content.json\");\n  }\n\n  handleImportJson(file: File) {\n    this.logger.info(() => `importJson`);\n    if (!file) {\n      this.logger.info(() => `No selected file`);\n      return null;\n    }\n    const reader = new FileReader();\n    reader.readAsText(file);\n    reader.onload = () => {\n      const content = reader.result;\n      this.logger.info(() => `File read completed`);\n      if (content != null) {\n        const json = content as string;\n        const obj = JSON.parse(json);\n        this.logger.info(() => `File is a valid json`);\n        this.context = new ContextDeserializer().deserializeContext(obj);\n        this.logger.info(() => `File is imported`);\n      }\n    };\n  }\n\n  handleUpdateDate(value: string): void {\n    this.logger.info(() => `Update date: ${value}`);\n    const dateService = ApplicationContext.getInstance().getDateService();\n    this.context.date = dateService.parse(value);\n\n    // make vue aware of the update\n    this.context.workShifts.length;\n  }\n  handleClearData(): void {\n    this.context.deleteShifts();\n  }\n  handleOptimize(): void {\n    this.logger.info(() => `Optimize`);\n    ApplicationContext.getInstance()\n      .getOptimizeShiftsService()\n      .optimize(this.context);\n  }\n  days(): number {\n    return ApplicationContext.getInstance()\n      .getDateService()\n      .range(this.rangeStart(), this.rangeEnd()).length;\n  }\n  day(index: number): Date {\n    const d = ApplicationContext.getInstance()\n      .getDateService()\n      .range(this.rangeStart(), this.rangeEnd())[index - 1];\n    return d;\n  }\n  rangeStart(): Date {\n    return ApplicationContext.getInstance()\n      .getWorkShiftService()\n      .rangeStart(this.context.date);\n  }\n  rangeEnd(): Date {\n    return ApplicationContext.getInstance()\n      .getWorkShiftService()\n      .rangeEnd(this.context.date);\n  }\n  handleShift(employeeId: number, date: Date, value: string): void {\n    this.logger.info(\n      () => `New shift, employee ${employeeId}, day ${date}, value=${value}`\n    );\n    this.context.setShift(employeeId, date, value);\n  }\n  private static employee(\n    context: WorkContext,\n    id: number,\n    name: string,\n    subgroup: number | null,\n    totWeekShifts: number,\n    maxWeekMornings: number,\n    maxWeekAfternoons: number\n  ): Employee {\n    const employee = new Employee();\n    employee.id = id;\n    employee.name = name;\n    employee.totWeekShifts = totWeekShifts;\n    employee.maxWeekMornings = maxWeekMornings;\n    employee.maxWeekAfternoons = maxWeekAfternoons;\n    employee.subgroupId = subgroup;\n    context.employees.set(id, employee);\n    return employee;\n  }\n\n  private static group(\n    context: WorkContext,\n    id: number,\n    name: string,\n    constraints: WeekConstraint[]\n  ): Group {\n    const group = new Group();\n    group.id = id;\n    group.name = name;\n    group.constraints = constraints.map(c => c.clone());\n    context.groups.set(id, group);\n    return group;\n  }\n\n  private static subgroup(\n    context: WorkContext,\n    id: number,\n    name: string,\n    parentId: number,\n    constraints: WeekConstraint[]\n  ): Group {\n    const subgroup = new Subgroup();\n    subgroup.id = id;\n    subgroup.name = name;\n    subgroup.parent = parentId;\n    subgroup.constraints = constraints.map(c => c.clone());\n    context.subgroups.set(id, subgroup);\n    return subgroup;\n  }\n\n  private static weekConstraint(\n    minMorningsWeekdays: number,\n    minAfternoonsWeekdays: number,\n    minMorningsWeekends: number,\n    minAfternoonsWeekends: number\n  ): WeekConstraint[] {\n    const list = new Array<WeekConstraint>();\n\n    const dateService = ApplicationContext.getInstance().getDateService();\n    dateService.getWeekdays().forEach(day => {\n      list.push(WeekConstraint.min(day, Action.MORNING, minMorningsWeekdays));\n      list.push(\n        WeekConstraint.min(day, Action.AFTERNOON, minAfternoonsWeekdays)\n      );\n    });\n    dateService.getWeekendDays().forEach(day => {\n      list.push(WeekConstraint.min(day, Action.MORNING, minMorningsWeekends));\n      list.push(\n        WeekConstraint.min(day, Action.AFTERNOON, minAfternoonsWeekends)\n      );\n    });\n    return list;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=03f0321e&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VAppBar } from 'vuetify/lib/components/VAppBar';\nimport { VContent } from 'vuetify/lib/components/VContent';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VApp,VAppBar,VContent,VRow})\n","import Vue from \"vue\";\nimport Vuex from \"vuex\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n    count: 0,\n    fromDate: new Date().toISOString().slice(0, 10),\n    toDate: new Date().toISOString().slice(0, 10)\n  },\n  mutations: {\n    increment(state) {\n      state.count++;\n    },\n    updateFromDate(state, date) {\n      state.fromDate = date;\n    },\n    updateToDate(state, date) {\n      state.toDate = date;\n    }\n  },\n  actions: {},\n  modules: {}\n});\n","import Vue from \"vue\";\nimport Vuetify from \"vuetify/lib\";\n\nVue.use(Vuetify);\n\nexport default new Vuetify({});\n","import \"babel-polyfill\";\nimport Vue from \"vue\";\nimport App from \"./App.vue\";\nimport store from \"./store\";\nimport Vuetify from \"vuetify\";\nimport \"vuetify/dist/vuetify.min.css\";\nimport vuetify from \"./plugins/vuetify\";\nimport axios from \"axios\";\n\nVue.use(Vuetify);\nVue.config.productionTip = false;\n\nnew Vue({\n  store,\n  vuetify,\n  render: h => h(App)\n}).$mount(\"#app\");\n"],"sourceRoot":""}